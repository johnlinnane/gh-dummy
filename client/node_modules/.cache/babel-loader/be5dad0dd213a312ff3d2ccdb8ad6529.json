{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar redux_1 = require(\"redux\");\n\nvar reducers_1 = require(\"./reducers\");\n\nvar dragDrop_1 = require(\"./actions/dragDrop\");\n\nvar DragDropMonitorImpl_1 = require(\"./DragDropMonitorImpl\");\n\nvar HandlerRegistryImpl_1 = require(\"./HandlerRegistryImpl\");\n\nvar DragDropManagerImpl =\n/** @class */\nfunction () {\n  function DragDropManagerImpl(createBackend, context) {\n    if (context === void 0) {\n      context = {};\n    }\n\n    this.context = context;\n    this.isSetUp = false;\n    var store = redux_1.createStore(reducers_1.default);\n    this.store = store;\n    this.monitor = new DragDropMonitorImpl_1.default(store, new HandlerRegistryImpl_1.default(store));\n    this.backend = createBackend(this);\n    store.subscribe(this.handleRefCountChange.bind(this));\n  }\n\n  DragDropManagerImpl.prototype.getContext = function () {\n    return this.context;\n  };\n\n  DragDropManagerImpl.prototype.getMonitor = function () {\n    return this.monitor;\n  };\n\n  DragDropManagerImpl.prototype.getBackend = function () {\n    return this.backend;\n  };\n\n  DragDropManagerImpl.prototype.getRegistry = function () {\n    return this.monitor.registry;\n  };\n\n  DragDropManagerImpl.prototype.getActions = function () {\n    var manager = this;\n    var dispatch = this.store.dispatch;\n\n    function bindActionCreator(actionCreator) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var action = actionCreator.apply(manager, args);\n\n        if (typeof action !== 'undefined') {\n          dispatch(action);\n        }\n      };\n    }\n\n    var actions = dragDrop_1.default(this);\n    return Object.keys(actions).reduce(function (boundActions, key) {\n      var action = actions[key];\n      boundActions[key] = bindActionCreator(action);\n      return boundActions;\n    }, {});\n  };\n\n  DragDropManagerImpl.prototype.dispatch = function (action) {\n    this.store.dispatch(action);\n  };\n\n  DragDropManagerImpl.prototype.handleRefCountChange = function () {\n    var shouldSetUp = this.store.getState().refCount > 0;\n\n    if (shouldSetUp && !this.isSetUp) {\n      this.backend.setup();\n      this.isSetUp = true;\n    } else if (!shouldSetUp && this.isSetUp) {\n      this.backend.teardown();\n      this.isSetUp = false;\n    }\n  };\n\n  return DragDropManagerImpl;\n}();\n\nexports.default = DragDropManagerImpl;","map":{"version":3,"sources":["/Users/johnlinnane/DEV/tc-book/node_modules/react-dnd/node_modules/dnd-core/lib/DragDropManagerImpl.js"],"names":["Object","defineProperty","exports","value","redux_1","require","reducers_1","dragDrop_1","DragDropMonitorImpl_1","HandlerRegistryImpl_1","DragDropManagerImpl","createBackend","context","isSetUp","store","createStore","default","monitor","backend","subscribe","handleRefCountChange","bind","prototype","getContext","getMonitor","getBackend","getRegistry","registry","getActions","manager","dispatch","bindActionCreator","actionCreator","args","_i","arguments","length","action","apply","actions","keys","reduce","boundActions","key","shouldSetUp","getState","refCount","setup","teardown"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar redux_1 = require(\"redux\");\nvar reducers_1 = require(\"./reducers\");\nvar dragDrop_1 = require(\"./actions/dragDrop\");\nvar DragDropMonitorImpl_1 = require(\"./DragDropMonitorImpl\");\nvar HandlerRegistryImpl_1 = require(\"./HandlerRegistryImpl\");\nvar DragDropManagerImpl = /** @class */ (function () {\n    function DragDropManagerImpl(createBackend, context) {\n        if (context === void 0) { context = {}; }\n        this.context = context;\n        this.isSetUp = false;\n        var store = redux_1.createStore(reducers_1.default);\n        this.store = store;\n        this.monitor = new DragDropMonitorImpl_1.default(store, new HandlerRegistryImpl_1.default(store));\n        this.backend = createBackend(this);\n        store.subscribe(this.handleRefCountChange.bind(this));\n    }\n    DragDropManagerImpl.prototype.getContext = function () {\n        return this.context;\n    };\n    DragDropManagerImpl.prototype.getMonitor = function () {\n        return this.monitor;\n    };\n    DragDropManagerImpl.prototype.getBackend = function () {\n        return this.backend;\n    };\n    DragDropManagerImpl.prototype.getRegistry = function () {\n        return this.monitor.registry;\n    };\n    DragDropManagerImpl.prototype.getActions = function () {\n        var manager = this;\n        var dispatch = this.store.dispatch;\n        function bindActionCreator(actionCreator) {\n            return function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var action = actionCreator.apply(manager, args);\n                if (typeof action !== 'undefined') {\n                    dispatch(action);\n                }\n            };\n        }\n        var actions = dragDrop_1.default(this);\n        return Object.keys(actions).reduce(function (boundActions, key) {\n            var action = actions[key];\n            boundActions[key] = bindActionCreator(action);\n            return boundActions;\n        }, {});\n    };\n    DragDropManagerImpl.prototype.dispatch = function (action) {\n        this.store.dispatch(action);\n    };\n    DragDropManagerImpl.prototype.handleRefCountChange = function () {\n        var shouldSetUp = this.store.getState().refCount > 0;\n        if (shouldSetUp && !this.isSetUp) {\n            this.backend.setup();\n            this.isSetUp = true;\n        }\n        else if (!shouldSetUp && this.isSetUp) {\n            this.backend.teardown();\n            this.isSetUp = false;\n        }\n    };\n    return DragDropManagerImpl;\n}());\nexports.default = DragDropManagerImpl;\n"]},"metadata":{},"sourceType":"script"}