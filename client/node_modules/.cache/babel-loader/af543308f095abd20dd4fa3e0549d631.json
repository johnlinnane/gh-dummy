{"ast":null,"code":"\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint-disable no-underscore-dangle */\n\nvar defaults_1 = __importDefault(require(\"lodash/defaults\"));\n\nvar EnterLeaveCounter_1 = __importDefault(require(\"./EnterLeaveCounter\"));\n\nvar BrowserDetector_1 = require(\"./BrowserDetector\");\n\nvar OffsetUtils_1 = require(\"./OffsetUtils\");\n\nvar NativeDragSources_1 = require(\"./NativeDragSources\");\n\nvar NativeTypes = __importStar(require(\"./NativeTypes\"));\n\nvar autobind_decorator_1 = __importDefault(require(\"autobind-decorator\"));\n\nvar shallowEqual = require('shallowequal');\n\nvar HTML5Backend =\n/** @class */\nfunction () {\n  function HTML5Backend(manager) {\n    this.sourcePreviewNodes = {};\n    this.sourcePreviewNodeOptions = {};\n    this.sourceNodes = {};\n    this.sourceNodeOptions = {};\n    this.enterLeaveCounter = new EnterLeaveCounter_1.default();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.currentDragSourceNodeOffset = null;\n    this.currentDragSourceNodeOffsetChanged = false;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.context = manager.getContext();\n  }\n\n  Object.defineProperty(HTML5Backend.prototype, \"window\", {\n    // public for test\n    get: function () {\n      if (this.context && this.context.window) {\n        return this.context.window;\n      } else if (typeof window !== 'undefined') {\n        return window;\n      }\n\n      return undefined;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HTML5Backend.prototype.setup = function () {\n    if (this.window === undefined) {\n      return;\n    }\n\n    if (this.window.__isReactDndBackendSetUp) {\n      throw new Error('Cannot have two HTML5 backends at the same time.');\n    }\n\n    this.window.__isReactDndBackendSetUp = true;\n    this.addEventListeners(this.window);\n  };\n\n  HTML5Backend.prototype.teardown = function () {\n    if (this.window === undefined) {\n      return;\n    }\n\n    this.window.__isReactDndBackendSetUp = false;\n    this.removeEventListeners(this.window);\n    this.clearCurrentDragSourceNode();\n\n    if (this.asyncEndDragFrameId) {\n      this.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n    }\n  };\n\n  HTML5Backend.prototype.connectDragPreview = function (sourceId, node, options) {\n    var _this = this;\n\n    this.sourcePreviewNodeOptions[sourceId] = options;\n    this.sourcePreviewNodes[sourceId] = node;\n    return function () {\n      delete _this.sourcePreviewNodes[sourceId];\n      delete _this.sourcePreviewNodeOptions[sourceId];\n    };\n  };\n\n  HTML5Backend.prototype.connectDragSource = function (sourceId, node, options) {\n    var _this = this;\n\n    this.sourceNodes[sourceId] = node;\n    this.sourceNodeOptions[sourceId] = options;\n\n    var handleDragStart = function (e) {\n      return _this.handleDragStart(e, sourceId);\n    };\n\n    var handleSelectStart = function (e) {\n      return _this.handleSelectStart(e);\n    };\n\n    node.setAttribute('draggable', true);\n    node.addEventListener('dragstart', handleDragStart);\n    node.addEventListener('selectstart', handleSelectStart);\n    return function () {\n      delete _this.sourceNodes[sourceId];\n      delete _this.sourceNodeOptions[sourceId];\n      node.removeEventListener('dragstart', handleDragStart);\n      node.removeEventListener('selectstart', handleSelectStart);\n      node.setAttribute('draggable', false);\n    };\n  };\n\n  HTML5Backend.prototype.connectDropTarget = function (targetId, node) {\n    var _this = this;\n\n    var handleDragEnter = function (e) {\n      return _this.handleDragEnter(e, targetId);\n    };\n\n    var handleDragOver = function (e) {\n      return _this.handleDragOver(e, targetId);\n    };\n\n    var handleDrop = function (e) {\n      return _this.handleDrop(e, targetId);\n    };\n\n    node.addEventListener('dragenter', handleDragEnter);\n    node.addEventListener('dragover', handleDragOver);\n    node.addEventListener('drop', handleDrop);\n    return function () {\n      node.removeEventListener('dragenter', handleDragEnter);\n      node.removeEventListener('dragover', handleDragOver);\n      node.removeEventListener('drop', handleDrop);\n    };\n  };\n\n  HTML5Backend.prototype.addEventListeners = function (target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.addEventListener) {\n      return;\n    }\n\n    target.addEventListener('dragstart', this.handleTopDragStart);\n    target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.addEventListener('dragenter', this.handleTopDragEnter);\n    target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.addEventListener('dragover', this.handleTopDragOver);\n    target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.addEventListener('drop', this.handleTopDrop);\n    target.addEventListener('drop', this.handleTopDropCapture, true);\n  };\n\n  HTML5Backend.prototype.removeEventListeners = function (target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.removeEventListener) {\n      return;\n    }\n\n    target.removeEventListener('dragstart', this.handleTopDragStart);\n    target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.removeEventListener('dragenter', this.handleTopDragEnter);\n    target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.removeEventListener('dragover', this.handleTopDragOver);\n    target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.removeEventListener('drop', this.handleTopDrop);\n    target.removeEventListener('drop', this.handleTopDropCapture, true);\n  };\n\n  HTML5Backend.prototype.getCurrentSourceNodeOptions = function () {\n    var sourceId = this.monitor.getSourceId();\n    var sourceNodeOptions = this.sourceNodeOptions[sourceId];\n    return defaults_1.default(sourceNodeOptions || {}, {\n      dropEffect: this.altKeyPressed ? 'copy' : 'move'\n    });\n  };\n\n  HTML5Backend.prototype.getCurrentDropEffect = function () {\n    if (this.isDraggingNativeItem()) {\n      // It makes more sense to default to 'copy' for native resources\n      return 'copy';\n    }\n\n    return this.getCurrentSourceNodeOptions().dropEffect;\n  };\n\n  HTML5Backend.prototype.getCurrentSourcePreviewNodeOptions = function () {\n    var sourceId = this.monitor.getSourceId();\n    var sourcePreviewNodeOptions = this.sourcePreviewNodeOptions[sourceId];\n    return defaults_1.default(sourcePreviewNodeOptions || {}, {\n      anchorX: 0.5,\n      anchorY: 0.5,\n      captureDraggingState: false\n    });\n  };\n\n  HTML5Backend.prototype.getSourceClientOffset = function (sourceId) {\n    return OffsetUtils_1.getNodeClientOffset(this.sourceNodes[sourceId]);\n  };\n\n  HTML5Backend.prototype.isDraggingNativeItem = function () {\n    var itemType = this.monitor.getItemType();\n    return Object.keys(NativeTypes).some(function (key) {\n      return NativeTypes[key] === itemType;\n    });\n  };\n\n  HTML5Backend.prototype.beginDragNativeItem = function (type) {\n    this.clearCurrentDragSourceNode();\n    var SourceType = NativeDragSources_1.createNativeDragSource(type);\n    this.currentNativeSource = new SourceType();\n    this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n    this.actions.beginDrag([this.currentNativeHandle]);\n  };\n\n  HTML5Backend.prototype.asyncEndDragNativeItem = function () {\n    if (this.window) {\n      this.asyncEndDragFrameId = this.window.requestAnimationFrame(this.endDragNativeItem);\n    }\n  };\n\n  HTML5Backend.prototype.endDragNativeItem = function () {\n    if (!this.isDraggingNativeItem()) {\n      return;\n    }\n\n    this.actions.endDrag();\n    this.registry.removeSource(this.currentNativeHandle);\n    this.currentNativeHandle = null;\n    this.currentNativeSource = null;\n  };\n\n  HTML5Backend.prototype.isNodeInDocument = function (node) {\n    // Check the node either in the main document or in the current context\n    return !!document && document.body.contains(node) || !!this.window && this.window.document.body.contains(node);\n  };\n\n  HTML5Backend.prototype.endDragIfSourceWasRemovedFromDOM = function () {\n    var node = this.currentDragSourceNode;\n\n    if (this.isNodeInDocument(node)) {\n      return;\n    }\n\n    if (this.clearCurrentDragSourceNode()) {\n      this.actions.endDrag();\n    }\n  };\n\n  HTML5Backend.prototype.setCurrentDragSourceNode = function (node) {\n    var _this = this;\n\n    this.clearCurrentDragSourceNode();\n    this.currentDragSourceNode = node;\n    this.currentDragSourceNodeOffset = OffsetUtils_1.getNodeClientOffset(node);\n    this.currentDragSourceNodeOffsetChanged = false; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n\n    var MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n    // means it has ended and the drag source node disappeared from DOM,\n    // so the browser didn't dispatch the dragend event.\n    //\n    // We need to wait before we start listening for mousemove events.\n    // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n    // immediately in some browsers.\n    //\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    //\n\n    this.mouseMoveTimeoutTimer = setTimeout(function () {\n      _this.mouseMoveTimeoutId = null;\n      return _this.window && _this.window.addEventListener('mousemove', _this.endDragIfSourceWasRemovedFromDOM, true);\n    }, MOUSE_MOVE_TIMEOUT);\n  };\n\n  HTML5Backend.prototype.clearCurrentDragSourceNode = function () {\n    if (this.currentDragSourceNode) {\n      this.currentDragSourceNode = null;\n      this.currentDragSourceNodeOffset = null;\n      this.currentDragSourceNodeOffsetChanged = false;\n\n      if (this.window) {\n        this.window.clearTimeout(this.mouseMoveTimeoutTimer);\n        this.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n      }\n\n      this.mouseMoveTimeoutTimer = null;\n      return true;\n    }\n\n    return false;\n  };\n\n  HTML5Backend.prototype.checkIfCurrentDragSourceRectChanged = function () {\n    var node = this.currentDragSourceNode;\n\n    if (!node) {\n      return false;\n    }\n\n    if (this.currentDragSourceNodeOffsetChanged) {\n      return true;\n    }\n\n    this.currentDragSourceNodeOffsetChanged = !shallowEqual(OffsetUtils_1.getNodeClientOffset(node), this.currentDragSourceNodeOffset);\n    return this.currentDragSourceNodeOffsetChanged;\n  };\n\n  HTML5Backend.prototype.handleTopDragStartCapture = function () {\n    this.clearCurrentDragSourceNode();\n    this.dragStartSourceIds = [];\n  };\n\n  HTML5Backend.prototype.handleDragStart = function (e, sourceId) {\n    if (!this.dragStartSourceIds) {\n      this.dragStartSourceIds = [];\n    }\n\n    this.dragStartSourceIds.unshift(sourceId);\n  };\n\n  HTML5Backend.prototype.handleTopDragStart = function (e) {\n    var _this = this;\n\n    var dragStartSourceIds = this.dragStartSourceIds;\n    this.dragStartSourceIds = null;\n    var clientOffset = OffsetUtils_1.getEventClientOffset(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n    if (this.monitor.isDragging()) {\n      this.actions.endDrag();\n    } // Don't publish the source just yet (see why below)\n\n\n    this.actions.beginDrag(dragStartSourceIds || [], {\n      publishSource: false,\n      getSourceClientOffset: this.getSourceClientOffset,\n      clientOffset: clientOffset\n    });\n    var dataTransfer = e.dataTransfer;\n    var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n\n    if (this.monitor.isDragging()) {\n      if (typeof dataTransfer.setDragImage === 'function') {\n        // Use custom drag image if user specifies it.\n        // If child drag source refuses drag but parent agrees,\n        // use parent's node as drag image. Neither works in IE though.\n        var sourceId = this.monitor.getSourceId();\n        var sourceNode = this.sourceNodes[sourceId];\n        var dragPreview = this.sourcePreviewNodes[sourceId] || sourceNode;\n\n        var _a = this.getCurrentSourcePreviewNodeOptions(),\n            anchorX = _a.anchorX,\n            anchorY = _a.anchorY,\n            offsetX = _a.offsetX,\n            offsetY = _a.offsetY;\n\n        var anchorPoint = {\n          anchorX: anchorX,\n          anchorY: anchorY\n        };\n        var offsetPoint = {\n          offsetX: offsetX,\n          offsetY: offsetY\n        };\n        var dragPreviewOffset = OffsetUtils_1.getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n        dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n      }\n\n      try {\n        // Firefox won't drag without setting data\n        dataTransfer.setData('application/json', {});\n      } catch (err) {} // IE doesn't support MIME types in setData\n      // Store drag source node so we can check whether\n      // it is removed from DOM and trigger endDrag manually.\n\n\n      this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n      var captureDraggingState = this.getCurrentSourcePreviewNodeOptions().captureDraggingState;\n\n      if (!captureDraggingState) {\n        // Usually we want to publish it in the next tick so that browser\n        // is able to screenshot the current (not yet dragging) state.\n        //\n        // It also neatly avoids a situation where render() returns null\n        // in the same tick for the source element, and browser freaks out.\n        setTimeout(function () {\n          return _this.actions.publishDragSource();\n        }, 0);\n      } else {\n        // In some cases the user may want to override this behavior, e.g.\n        // to work around IE not supporting custom drag previews.\n        //\n        // When using a custom drag layer, the only way to prevent\n        // the default drag preview from drawing in IE is to screenshot\n        // the dragging state in which the node itself has zero opacity\n        // and height. In this case, though, returning null from render()\n        // will abruptly end the dragging, which is not obvious.\n        //\n        // This is the reason such behavior is strictly opt-in.\n        this.actions.publishDragSource();\n      }\n    } else if (nativeType) {\n      // A native item (such as URL) dragged from inside the document\n      this.beginDragNativeItem(nativeType);\n    } else if (!dataTransfer.types && (!e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n      // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n      // Just let it drag. It's a native type (URL or text) and will be picked up in\n      // dragenter handler.\n      return; // eslint-disable-line no-useless-return\n    } else {\n      // If by this time no drag source reacted, tell browser not to drag.\n      e.preventDefault();\n    }\n  };\n\n  HTML5Backend.prototype.handleTopDragEndCapture = function () {\n    if (this.clearCurrentDragSourceNode()) {\n      // Firefox can dispatch this event in an infinite loop\n      // if dragend handler does something like showing an alert.\n      // Only proceed if we have not handled it already.\n      this.actions.endDrag();\n    }\n  };\n\n  HTML5Backend.prototype.handleTopDragEnterCapture = function (e) {\n    this.dragEnterTargetIds = [];\n    var isFirstEnter = this.enterLeaveCounter.enter(e.target);\n\n    if (!isFirstEnter || this.monitor.isDragging()) {\n      return;\n    }\n\n    var dataTransfer = e.dataTransfer;\n    var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n\n    if (nativeType) {\n      // A native item (such as file or URL) dragged from outside the document\n      this.beginDragNativeItem(nativeType);\n    }\n  };\n\n  HTML5Backend.prototype.handleDragEnter = function (e, targetId) {\n    this.dragEnterTargetIds.unshift(targetId);\n  };\n\n  HTML5Backend.prototype.handleTopDragEnter = function (e) {\n    var _this = this;\n\n    var dragEnterTargetIds = this.dragEnterTargetIds;\n    this.dragEnterTargetIds = [];\n\n    if (!this.monitor.isDragging()) {\n      // This is probably a native item type we don't understand.\n      return;\n    }\n\n    this.altKeyPressed = e.altKey;\n\n    if (!BrowserDetector_1.isFirefox()) {\n      // Don't emit hover in `dragenter` on Firefox due to an edge case.\n      // If the target changes position as the result of `dragenter`, Firefox\n      // will still happily dispatch `dragover` despite target being no longer\n      // there. The easy solution is to only fire `hover` in `dragover` on FF.\n      this.actions.hover(dragEnterTargetIds, {\n        clientOffset: OffsetUtils_1.getEventClientOffset(e)\n      });\n    }\n\n    var canDrop = dragEnterTargetIds.some(function (targetId) {\n      return _this.monitor.canDropOnTarget(targetId);\n    });\n\n    if (canDrop) {\n      // IE requires this to fire dragover events\n      e.preventDefault();\n      e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n    }\n  };\n\n  HTML5Backend.prototype.handleTopDragOverCapture = function () {\n    this.dragOverTargetIds = [];\n  };\n\n  HTML5Backend.prototype.handleDragOver = function (e, targetId) {\n    if (this.dragOverTargetIds === null) {\n      this.dragOverTargetIds = [];\n    }\n\n    this.dragOverTargetIds.unshift(targetId);\n  };\n\n  HTML5Backend.prototype.handleTopDragOver = function (e) {\n    var _this = this;\n\n    var dragOverTargetIds = this.dragOverTargetIds;\n    this.dragOverTargetIds = [];\n\n    if (!this.monitor.isDragging()) {\n      // This is probably a native item type we don't understand.\n      // Prevent default \"drop and blow away the whole document\" action.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = 'none';\n      return;\n    }\n\n    this.altKeyPressed = e.altKey;\n    this.actions.hover(dragOverTargetIds || [], {\n      clientOffset: OffsetUtils_1.getEventClientOffset(e)\n    });\n    var canDrop = (dragOverTargetIds || []).some(function (targetId) {\n      return _this.monitor.canDropOnTarget(targetId);\n    });\n\n    if (canDrop) {\n      // Show user-specified drop effect.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n    } else if (this.isDraggingNativeItem()) {\n      // Don't show a nice cursor but still prevent default\n      // \"drop and blow away the whole document\" action.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = 'none';\n    } else if (this.checkIfCurrentDragSourceRectChanged()) {\n      // Prevent animating to incorrect position.\n      // Drop effect must be other than 'none' to prevent animation.\n      e.preventDefault();\n      e.dataTransfer.dropEffect = 'move';\n    }\n  };\n\n  HTML5Backend.prototype.handleTopDragLeaveCapture = function (e) {\n    if (this.isDraggingNativeItem()) {\n      e.preventDefault();\n    }\n\n    var isLastLeave = this.enterLeaveCounter.leave(e.target);\n\n    if (!isLastLeave) {\n      return;\n    }\n\n    if (this.isDraggingNativeItem()) {\n      this.endDragNativeItem();\n    }\n  };\n\n  HTML5Backend.prototype.handleTopDropCapture = function (e) {\n    this.dropTargetIds = [];\n    e.preventDefault();\n\n    if (this.isDraggingNativeItem()) {\n      this.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer);\n    }\n\n    this.enterLeaveCounter.reset();\n  };\n\n  HTML5Backend.prototype.handleDrop = function (e, targetId) {\n    this.dropTargetIds.unshift(targetId);\n  };\n\n  HTML5Backend.prototype.handleTopDrop = function (e) {\n    var dropTargetIds = this.dropTargetIds;\n    this.dropTargetIds = [];\n    this.actions.hover(dropTargetIds, {\n      clientOffset: OffsetUtils_1.getEventClientOffset(e)\n    });\n    this.actions.drop({\n      dropEffect: this.getCurrentDropEffect()\n    });\n\n    if (this.isDraggingNativeItem()) {\n      this.endDragNativeItem();\n    } else {\n      this.endDragIfSourceWasRemovedFromDOM();\n    }\n  };\n\n  HTML5Backend.prototype.handleSelectStart = function (e) {\n    var target = e.target; // Only IE requires us to explicitly say\n    // we want drag drop operation to start\n\n    if (typeof target.dragDrop !== 'function') {\n      return;\n    } // Inputs and textareas should be selectable\n\n\n    if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n      return;\n    } // For other targets, ask IE\n    // to enable drag and drop\n\n\n    e.preventDefault();\n    target.dragDrop();\n  };\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"getSourceClientOffset\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"asyncEndDragNativeItem\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"endDragNativeItem\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"isNodeInDocument\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"endDragIfSourceWasRemovedFromDOM\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragStartCapture\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragStart\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragEndCapture\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragEnterCapture\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragEnter\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragOverCapture\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragOver\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDragLeaveCapture\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDropCapture\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleTopDrop\", null);\n\n  __decorate([autobind_decorator_1.default], HTML5Backend.prototype, \"handleSelectStart\", null);\n\n  return HTML5Backend;\n}();\n\nexports.default = HTML5Backend;","map":{"version":3,"sources":["../src/HTML5Backend.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* eslint-disable no-underscore-dangle */\nvar defaults_1 = __importDefault(require(\"lodash/defaults\"));\nvar EnterLeaveCounter_1 = __importDefault(require(\"./EnterLeaveCounter\"));\nvar BrowserDetector_1 = require(\"./BrowserDetector\");\nvar OffsetUtils_1 = require(\"./OffsetUtils\");\nvar NativeDragSources_1 = require(\"./NativeDragSources\");\nvar NativeTypes = __importStar(require(\"./NativeTypes\"));\nvar autobind_decorator_1 = __importDefault(require(\"autobind-decorator\"));\nvar shallowEqual = require('shallowequal');\nvar HTML5Backend = /** @class */ (function () {\n    function HTML5Backend(manager) {\n        this.sourcePreviewNodes = {};\n        this.sourcePreviewNodeOptions = {};\n        this.sourceNodes = {};\n        this.sourceNodeOptions = {};\n        this.enterLeaveCounter = new EnterLeaveCounter_1.default();\n        this.dragStartSourceIds = null;\n        this.dropTargetIds = [];\n        this.dragEnterTargetIds = [];\n        this.currentNativeSource = null;\n        this.currentNativeHandle = null;\n        this.currentDragSourceNode = null;\n        this.currentDragSourceNodeOffset = null;\n        this.currentDragSourceNodeOffsetChanged = false;\n        this.altKeyPressed = false;\n        this.mouseMoveTimeoutTimer = null;\n        this.asyncEndDragFrameId = null;\n        this.dragOverTargetIds = null;\n        this.actions = manager.getActions();\n        this.monitor = manager.getMonitor();\n        this.registry = manager.getRegistry();\n        this.context = manager.getContext();\n    }\n    Object.defineProperty(HTML5Backend.prototype, \"window\", {\n        // public for test\n        get: function () {\n            if (this.context && this.context.window) {\n                return this.context.window;\n            }\n            else if (typeof window !== 'undefined') {\n                return window;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HTML5Backend.prototype.setup = function () {\n        if (this.window === undefined) {\n            return;\n        }\n        if (this.window.__isReactDndBackendSetUp) {\n            throw new Error('Cannot have two HTML5 backends at the same time.');\n        }\n        this.window.__isReactDndBackendSetUp = true;\n        this.addEventListeners(this.window);\n    };\n    HTML5Backend.prototype.teardown = function () {\n        if (this.window === undefined) {\n            return;\n        }\n        this.window.__isReactDndBackendSetUp = false;\n        this.removeEventListeners(this.window);\n        this.clearCurrentDragSourceNode();\n        if (this.asyncEndDragFrameId) {\n            this.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n        }\n    };\n    HTML5Backend.prototype.connectDragPreview = function (sourceId, node, options) {\n        var _this = this;\n        this.sourcePreviewNodeOptions[sourceId] = options;\n        this.sourcePreviewNodes[sourceId] = node;\n        return function () {\n            delete _this.sourcePreviewNodes[sourceId];\n            delete _this.sourcePreviewNodeOptions[sourceId];\n        };\n    };\n    HTML5Backend.prototype.connectDragSource = function (sourceId, node, options) {\n        var _this = this;\n        this.sourceNodes[sourceId] = node;\n        this.sourceNodeOptions[sourceId] = options;\n        var handleDragStart = function (e) { return _this.handleDragStart(e, sourceId); };\n        var handleSelectStart = function (e) { return _this.handleSelectStart(e); };\n        node.setAttribute('draggable', true);\n        node.addEventListener('dragstart', handleDragStart);\n        node.addEventListener('selectstart', handleSelectStart);\n        return function () {\n            delete _this.sourceNodes[sourceId];\n            delete _this.sourceNodeOptions[sourceId];\n            node.removeEventListener('dragstart', handleDragStart);\n            node.removeEventListener('selectstart', handleSelectStart);\n            node.setAttribute('draggable', false);\n        };\n    };\n    HTML5Backend.prototype.connectDropTarget = function (targetId, node) {\n        var _this = this;\n        var handleDragEnter = function (e) { return _this.handleDragEnter(e, targetId); };\n        var handleDragOver = function (e) { return _this.handleDragOver(e, targetId); };\n        var handleDrop = function (e) { return _this.handleDrop(e, targetId); };\n        node.addEventListener('dragenter', handleDragEnter);\n        node.addEventListener('dragover', handleDragOver);\n        node.addEventListener('drop', handleDrop);\n        return function () {\n            node.removeEventListener('dragenter', handleDragEnter);\n            node.removeEventListener('dragover', handleDragOver);\n            node.removeEventListener('drop', handleDrop);\n        };\n    };\n    HTML5Backend.prototype.addEventListeners = function (target) {\n        // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n        if (!target.addEventListener) {\n            return;\n        }\n        target.addEventListener('dragstart', this.handleTopDragStart);\n        target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n        target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n        target.addEventListener('dragenter', this.handleTopDragEnter);\n        target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n        target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n        target.addEventListener('dragover', this.handleTopDragOver);\n        target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n        target.addEventListener('drop', this.handleTopDrop);\n        target.addEventListener('drop', this.handleTopDropCapture, true);\n    };\n    HTML5Backend.prototype.removeEventListeners = function (target) {\n        // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n        if (!target.removeEventListener) {\n            return;\n        }\n        target.removeEventListener('dragstart', this.handleTopDragStart);\n        target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n        target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n        target.removeEventListener('dragenter', this.handleTopDragEnter);\n        target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n        target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n        target.removeEventListener('dragover', this.handleTopDragOver);\n        target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n        target.removeEventListener('drop', this.handleTopDrop);\n        target.removeEventListener('drop', this.handleTopDropCapture, true);\n    };\n    HTML5Backend.prototype.getCurrentSourceNodeOptions = function () {\n        var sourceId = this.monitor.getSourceId();\n        var sourceNodeOptions = this.sourceNodeOptions[sourceId];\n        return defaults_1.default(sourceNodeOptions || {}, {\n            dropEffect: this.altKeyPressed ? 'copy' : 'move',\n        });\n    };\n    HTML5Backend.prototype.getCurrentDropEffect = function () {\n        if (this.isDraggingNativeItem()) {\n            // It makes more sense to default to 'copy' for native resources\n            return 'copy';\n        }\n        return this.getCurrentSourceNodeOptions().dropEffect;\n    };\n    HTML5Backend.prototype.getCurrentSourcePreviewNodeOptions = function () {\n        var sourceId = this.monitor.getSourceId();\n        var sourcePreviewNodeOptions = this.sourcePreviewNodeOptions[sourceId];\n        return defaults_1.default(sourcePreviewNodeOptions || {}, {\n            anchorX: 0.5,\n            anchorY: 0.5,\n            captureDraggingState: false,\n        });\n    };\n    HTML5Backend.prototype.getSourceClientOffset = function (sourceId) {\n        return OffsetUtils_1.getNodeClientOffset(this.sourceNodes[sourceId]);\n    };\n    HTML5Backend.prototype.isDraggingNativeItem = function () {\n        var itemType = this.monitor.getItemType();\n        return Object.keys(NativeTypes).some(function (key) { return NativeTypes[key] === itemType; });\n    };\n    HTML5Backend.prototype.beginDragNativeItem = function (type) {\n        this.clearCurrentDragSourceNode();\n        var SourceType = NativeDragSources_1.createNativeDragSource(type);\n        this.currentNativeSource = new SourceType();\n        this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n        this.actions.beginDrag([this.currentNativeHandle]);\n    };\n    HTML5Backend.prototype.asyncEndDragNativeItem = function () {\n        if (this.window) {\n            this.asyncEndDragFrameId = this.window.requestAnimationFrame(this.endDragNativeItem);\n        }\n    };\n    HTML5Backend.prototype.endDragNativeItem = function () {\n        if (!this.isDraggingNativeItem()) {\n            return;\n        }\n        this.actions.endDrag();\n        this.registry.removeSource(this.currentNativeHandle);\n        this.currentNativeHandle = null;\n        this.currentNativeSource = null;\n    };\n    HTML5Backend.prototype.isNodeInDocument = function (node) {\n        // Check the node either in the main document or in the current context\n        return ((!!document && document.body.contains(node)) ||\n            (!!this.window && this.window.document.body.contains(node)));\n    };\n    HTML5Backend.prototype.endDragIfSourceWasRemovedFromDOM = function () {\n        var node = this.currentDragSourceNode;\n        if (this.isNodeInDocument(node)) {\n            return;\n        }\n        if (this.clearCurrentDragSourceNode()) {\n            this.actions.endDrag();\n        }\n    };\n    HTML5Backend.prototype.setCurrentDragSourceNode = function (node) {\n        var _this = this;\n        this.clearCurrentDragSourceNode();\n        this.currentDragSourceNode = node;\n        this.currentDragSourceNodeOffset = OffsetUtils_1.getNodeClientOffset(node);\n        this.currentDragSourceNodeOffsetChanged = false;\n        // A timeout of > 0 is necessary to resolve Firefox issue referenced\n        // See:\n        //   * https://github.com/react-dnd/react-dnd/pull/928\n        //   * https://github.com/react-dnd/react-dnd/issues/869\n        var MOUSE_MOVE_TIMEOUT = 1000;\n        // Receiving a mouse event in the middle of a dragging operation\n        // means it has ended and the drag source node disappeared from DOM,\n        // so the browser didn't dispatch the dragend event.\n        //\n        // We need to wait before we start listening for mousemove events.\n        // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n        // immediately in some browsers.\n        //\n        // See:\n        //   * https://github.com/react-dnd/react-dnd/pull/928\n        //   * https://github.com/react-dnd/react-dnd/issues/869\n        //\n        this.mouseMoveTimeoutTimer = setTimeout(function () {\n            _this.mouseMoveTimeoutId = null;\n            return (_this.window &&\n                _this.window.addEventListener('mousemove', _this.endDragIfSourceWasRemovedFromDOM, true));\n        }, MOUSE_MOVE_TIMEOUT);\n    };\n    HTML5Backend.prototype.clearCurrentDragSourceNode = function () {\n        if (this.currentDragSourceNode) {\n            this.currentDragSourceNode = null;\n            this.currentDragSourceNodeOffset = null;\n            this.currentDragSourceNodeOffsetChanged = false;\n            if (this.window) {\n                this.window.clearTimeout(this.mouseMoveTimeoutTimer);\n                this.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n            }\n            this.mouseMoveTimeoutTimer = null;\n            return true;\n        }\n        return false;\n    };\n    HTML5Backend.prototype.checkIfCurrentDragSourceRectChanged = function () {\n        var node = this.currentDragSourceNode;\n        if (!node) {\n            return false;\n        }\n        if (this.currentDragSourceNodeOffsetChanged) {\n            return true;\n        }\n        this.currentDragSourceNodeOffsetChanged = !shallowEqual(OffsetUtils_1.getNodeClientOffset(node), this.currentDragSourceNodeOffset);\n        return this.currentDragSourceNodeOffsetChanged;\n    };\n    HTML5Backend.prototype.handleTopDragStartCapture = function () {\n        this.clearCurrentDragSourceNode();\n        this.dragStartSourceIds = [];\n    };\n    HTML5Backend.prototype.handleDragStart = function (e, sourceId) {\n        if (!this.dragStartSourceIds) {\n            this.dragStartSourceIds = [];\n        }\n        this.dragStartSourceIds.unshift(sourceId);\n    };\n    HTML5Backend.prototype.handleTopDragStart = function (e) {\n        var _this = this;\n        var dragStartSourceIds = this.dragStartSourceIds;\n        this.dragStartSourceIds = null;\n        var clientOffset = OffsetUtils_1.getEventClientOffset(e);\n        // Avoid crashing if we missed a drop event or our previous drag died\n        if (this.monitor.isDragging()) {\n            this.actions.endDrag();\n        }\n        // Don't publish the source just yet (see why below)\n        this.actions.beginDrag(dragStartSourceIds || [], {\n            publishSource: false,\n            getSourceClientOffset: this.getSourceClientOffset,\n            clientOffset: clientOffset,\n        });\n        var dataTransfer = e.dataTransfer;\n        var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n        if (this.monitor.isDragging()) {\n            if (typeof dataTransfer.setDragImage === 'function') {\n                // Use custom drag image if user specifies it.\n                // If child drag source refuses drag but parent agrees,\n                // use parent's node as drag image. Neither works in IE though.\n                var sourceId = this.monitor.getSourceId();\n                var sourceNode = this.sourceNodes[sourceId];\n                var dragPreview = this.sourcePreviewNodes[sourceId] || sourceNode;\n                var _a = this.getCurrentSourcePreviewNodeOptions(), anchorX = _a.anchorX, anchorY = _a.anchorY, offsetX = _a.offsetX, offsetY = _a.offsetY;\n                var anchorPoint = { anchorX: anchorX, anchorY: anchorY };\n                var offsetPoint = { offsetX: offsetX, offsetY: offsetY };\n                var dragPreviewOffset = OffsetUtils_1.getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n                dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n            }\n            try {\n                // Firefox won't drag without setting data\n                dataTransfer.setData('application/json', {});\n            }\n            catch (err) {\n                // IE doesn't support MIME types in setData\n            }\n            // Store drag source node so we can check whether\n            // it is removed from DOM and trigger endDrag manually.\n            this.setCurrentDragSourceNode(e.target);\n            // Now we are ready to publish the drag source.. or are we not?\n            var captureDraggingState = this.getCurrentSourcePreviewNodeOptions().captureDraggingState;\n            if (!captureDraggingState) {\n                // Usually we want to publish it in the next tick so that browser\n                // is able to screenshot the current (not yet dragging) state.\n                //\n                // It also neatly avoids a situation where render() returns null\n                // in the same tick for the source element, and browser freaks out.\n                setTimeout(function () { return _this.actions.publishDragSource(); }, 0);\n            }\n            else {\n                // In some cases the user may want to override this behavior, e.g.\n                // to work around IE not supporting custom drag previews.\n                //\n                // When using a custom drag layer, the only way to prevent\n                // the default drag preview from drawing in IE is to screenshot\n                // the dragging state in which the node itself has zero opacity\n                // and height. In this case, though, returning null from render()\n                // will abruptly end the dragging, which is not obvious.\n                //\n                // This is the reason such behavior is strictly opt-in.\n                this.actions.publishDragSource();\n            }\n        }\n        else if (nativeType) {\n            // A native item (such as URL) dragged from inside the document\n            this.beginDragNativeItem(nativeType);\n        }\n        else if (!dataTransfer.types &&\n            (!e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n            // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n            // Just let it drag. It's a native type (URL or text) and will be picked up in\n            // dragenter handler.\n            return; // eslint-disable-line no-useless-return\n        }\n        else {\n            // If by this time no drag source reacted, tell browser not to drag.\n            e.preventDefault();\n        }\n    };\n    HTML5Backend.prototype.handleTopDragEndCapture = function () {\n        if (this.clearCurrentDragSourceNode()) {\n            // Firefox can dispatch this event in an infinite loop\n            // if dragend handler does something like showing an alert.\n            // Only proceed if we have not handled it already.\n            this.actions.endDrag();\n        }\n    };\n    HTML5Backend.prototype.handleTopDragEnterCapture = function (e) {\n        this.dragEnterTargetIds = [];\n        var isFirstEnter = this.enterLeaveCounter.enter(e.target);\n        if (!isFirstEnter || this.monitor.isDragging()) {\n            return;\n        }\n        var dataTransfer = e.dataTransfer;\n        var nativeType = NativeDragSources_1.matchNativeItemType(dataTransfer);\n        if (nativeType) {\n            // A native item (such as file or URL) dragged from outside the document\n            this.beginDragNativeItem(nativeType);\n        }\n    };\n    HTML5Backend.prototype.handleDragEnter = function (e, targetId) {\n        this.dragEnterTargetIds.unshift(targetId);\n    };\n    HTML5Backend.prototype.handleTopDragEnter = function (e) {\n        var _this = this;\n        var dragEnterTargetIds = this.dragEnterTargetIds;\n        this.dragEnterTargetIds = [];\n        if (!this.monitor.isDragging()) {\n            // This is probably a native item type we don't understand.\n            return;\n        }\n        this.altKeyPressed = e.altKey;\n        if (!BrowserDetector_1.isFirefox()) {\n            // Don't emit hover in `dragenter` on Firefox due to an edge case.\n            // If the target changes position as the result of `dragenter`, Firefox\n            // will still happily dispatch `dragover` despite target being no longer\n            // there. The easy solution is to only fire `hover` in `dragover` on FF.\n            this.actions.hover(dragEnterTargetIds, {\n                clientOffset: OffsetUtils_1.getEventClientOffset(e),\n            });\n        }\n        var canDrop = dragEnterTargetIds.some(function (targetId) {\n            return _this.monitor.canDropOnTarget(targetId);\n        });\n        if (canDrop) {\n            // IE requires this to fire dragover events\n            e.preventDefault();\n            e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n    };\n    HTML5Backend.prototype.handleTopDragOverCapture = function () {\n        this.dragOverTargetIds = [];\n    };\n    HTML5Backend.prototype.handleDragOver = function (e, targetId) {\n        if (this.dragOverTargetIds === null) {\n            this.dragOverTargetIds = [];\n        }\n        this.dragOverTargetIds.unshift(targetId);\n    };\n    HTML5Backend.prototype.handleTopDragOver = function (e) {\n        var _this = this;\n        var dragOverTargetIds = this.dragOverTargetIds;\n        this.dragOverTargetIds = [];\n        if (!this.monitor.isDragging()) {\n            // This is probably a native item type we don't understand.\n            // Prevent default \"drop and blow away the whole document\" action.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = 'none';\n            return;\n        }\n        this.altKeyPressed = e.altKey;\n        this.actions.hover(dragOverTargetIds || [], {\n            clientOffset: OffsetUtils_1.getEventClientOffset(e),\n        });\n        var canDrop = (dragOverTargetIds || []).some(function (targetId) {\n            return _this.monitor.canDropOnTarget(targetId);\n        });\n        if (canDrop) {\n            // Show user-specified drop effect.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n        else if (this.isDraggingNativeItem()) {\n            // Don't show a nice cursor but still prevent default\n            // \"drop and blow away the whole document\" action.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = 'none';\n        }\n        else if (this.checkIfCurrentDragSourceRectChanged()) {\n            // Prevent animating to incorrect position.\n            // Drop effect must be other than 'none' to prevent animation.\n            e.preventDefault();\n            e.dataTransfer.dropEffect = 'move';\n        }\n    };\n    HTML5Backend.prototype.handleTopDragLeaveCapture = function (e) {\n        if (this.isDraggingNativeItem()) {\n            e.preventDefault();\n        }\n        var isLastLeave = this.enterLeaveCounter.leave(e.target);\n        if (!isLastLeave) {\n            return;\n        }\n        if (this.isDraggingNativeItem()) {\n            this.endDragNativeItem();\n        }\n    };\n    HTML5Backend.prototype.handleTopDropCapture = function (e) {\n        this.dropTargetIds = [];\n        e.preventDefault();\n        if (this.isDraggingNativeItem()) {\n            this.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer);\n        }\n        this.enterLeaveCounter.reset();\n    };\n    HTML5Backend.prototype.handleDrop = function (e, targetId) {\n        this.dropTargetIds.unshift(targetId);\n    };\n    HTML5Backend.prototype.handleTopDrop = function (e) {\n        var dropTargetIds = this.dropTargetIds;\n        this.dropTargetIds = [];\n        this.actions.hover(dropTargetIds, {\n            clientOffset: OffsetUtils_1.getEventClientOffset(e),\n        });\n        this.actions.drop({ dropEffect: this.getCurrentDropEffect() });\n        if (this.isDraggingNativeItem()) {\n            this.endDragNativeItem();\n        }\n        else {\n            this.endDragIfSourceWasRemovedFromDOM();\n        }\n    };\n    HTML5Backend.prototype.handleSelectStart = function (e) {\n        var target = e.target;\n        // Only IE requires us to explicitly say\n        // we want drag drop operation to start\n        if (typeof target.dragDrop !== 'function') {\n            return;\n        }\n        // Inputs and textareas should be selectable\n        if (target.tagName === 'INPUT' ||\n            target.tagName === 'SELECT' ||\n            target.tagName === 'TEXTAREA' ||\n            target.isContentEditable) {\n            return;\n        }\n        // For other targets, ask IE\n        // to enable drag and drop\n        e.preventDefault();\n        target.dragDrop();\n    };\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"getSourceClientOffset\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"asyncEndDragNativeItem\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"endDragNativeItem\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"isNodeInDocument\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"endDragIfSourceWasRemovedFromDOM\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragStartCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragStart\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragEndCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragEnterCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragEnter\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragOverCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragOver\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDragLeaveCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDropCapture\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleTopDrop\", null);\n    __decorate([\n        autobind_decorator_1.default\n    ], HTML5Backend.prototype, \"handleSelectStart\", null);\n    return HTML5Backend;\n}());\nexports.default = HTML5Backend;\n//# sourceMappingURL=HTML5Backend.js.map"]},"metadata":{},"sourceType":"script"}