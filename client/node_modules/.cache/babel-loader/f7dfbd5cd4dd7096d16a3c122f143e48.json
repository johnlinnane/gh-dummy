{"ast":null,"code":"var _jsxFileName = \"/Users/johnlinnane/DEV/traveller-collection/client/src/components/Items/item_view.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport Slick from 'react-slick'; // uses cdn css\n\nimport { Document, Page, pdfjs } from 'react-pdf'; // import PDFViewer from 'pdf-viewer-reactjs'\n// import { getBookWithReviewer, clearBookWithReviewer } from '../../actions'; // OLD !\n\nimport { getItemWithContributor, clearItemWithContributor, getAllCats, getAllSubCats, getNextItem, getPrevItem } from '../../actions';\nimport NavigationBar from '../../widgetsUI/navigation'; // import Image from '../../widgetsUI/Slider/slider';\n\nimport ItemImageSlider from '../../widgetsUI/Slider/item_img_slider';\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\n\nclass ItemView extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      pdfError: false,\n      numPages: null,\n      setNumPages: null,\n      pageNumber: 1,\n      setPageNumber: 1,\n      pdfPageNumber: 0\n    };\n    this.navInfo = {\n      catTitle: null,\n      catId: null,\n      subCatTitle: null,\n      subCatId: null,\n      type: 'Categories'\n    };\n\n    this.addDefaultImg = ev => {\n      const newImg = '/images/default/default.jpg';\n\n      if (ev.target.src !== newImg) {\n        ev.target.src = newImg;\n      }\n    };\n\n    this.getCatName = catId => {\n      if (this.props.cats && this.props.cats.length) {\n        this.props.cats.map(cat => {\n          if (cat._id === catId[0]) {\n            // console.log(cat.title);\n            this.navInfo.catTitle = cat.title;\n            this.navInfo.catId = cat._id;\n          }\n\n          return null;\n        });\n      }\n    };\n\n    this.getSubCatName = subCatId => {\n      // console.log(subCatId);\n      if (this.props.subcats && this.props.subcats.length) {\n        this.props.subcats.map(subcat => {\n          if (subcat._id == subCatId[0]) {\n            // console.log(cat.title);\n            this.navInfo.subCatTitle = subcat.title;\n            this.navInfo.subCatId = subcat._id;\n          }\n        });\n      }\n    };\n\n    this.nextItem = () => {};\n\n    this.handlePageChange = event => {\n      this.setState({\n        pageNumber: event.target.value\n      });\n    };\n\n    this.renderField = (text, ref) => {\n      if (ref) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"item_field link_blue\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 24\n          }\n        }, text)), /*#__PURE__*/React.createElement(\"span\", {\n          dangerouslySetInnerHTML: {\n            __html: ref\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 21\n          }\n        }));\n      }\n    };\n\n    this.renderSlider = items => {\n      const settings = {\n        dots: true,\n        infinite: false,\n        arrows: true,\n        speed: 500,\n        slidesToShow: 1,\n        slidesToScroll: 1,\n        className: 'slick_slider' // variableWidth: true\n        // ...props.settings\n\n      };\n      var divs = [];\n\n      for (var i = 0; i < items.item.number_files; i++) {\n        divs.push( /*#__PURE__*/React.createElement(\"div\", {\n          key: i,\n          className: \"featured_item\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"featured_image\",\n          style: {\n            background: `url(/images/items/${items.item._id}/original/${i}.jpg)` // <img src={`/images/items/${items.item._id}/original/0.jpg`} alt=\"Item\" onError={this.addDefaultImg}/>\n\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 21\n          }\n        })));\n      }\n\n      return /*#__PURE__*/React.createElement(Slick, Object.assign({}, settings, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 16\n        }\n      }), divs);\n    };\n\n    this.renderPDF = () => {\n      // ************* PDF STUFF *************\n      const {\n        pageNumber,\n        setPageNumber,\n        numPages,\n        setNumPages\n      } = this.state;\n\n      const onDocumentLoadSuccess = ({\n        numPages\n      }) => {\n        this.setState({\n          numPages\n        });\n        this.setState({\n          pageNumber: 1\n        });\n      };\n\n      const changePage = offset => {\n        this.setState({\n          pageNumber: pageNumber + offset\n        });\n      };\n\n      const previousPage = () => {\n        changePage(-1);\n      };\n\n      const nextPage = () => {\n        changePage(1);\n      }; // ***************************************\n\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pdf_wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"pdf\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Document, {\n        file: \"/images/items/5eb4417bf2ff151113f3e178/original/0.pdf\",\n        onLoadSuccess: onDocumentLoadSuccess // onLoadError={this.setState({ pdfError: true })}\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Page, {\n        className: \"pdf_page\",\n        pageNumber: pageNumber // width={Math.min(width * 0.9, 400)} \n        ,\n        width: 650 // scale={0.5}\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        disabled: pageNumber <= 1,\n        onClick: previousPage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 17\n        }\n      }, \"Previous\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        disabled: pageNumber >= numPages,\n        onClick: nextPage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 17\n        }\n      }, \"Next\"), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 17\n        }\n      }, \"Page \", pageNumber || (numPages ? 1 : '--'), \" of \", numPages || '--'), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/images/items/5eb4417bf2ff151113f3e178/original/0.pdf\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 17\n        }\n      }, \"[pdf]\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        placeholder: \"placeholder\",\n        defaultValue: this.state.pageNumber,\n        onChange: event => this.handlePageChange(event),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 17\n        }\n      }, this.state.pageNumber));\n    };\n\n    this.renderItem = items => {\n      console.log(items);\n      return items.item ? /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_header\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 25\n        }\n      }, items.item.title), items.item.file_format == 'mp4' ? /*#__PURE__*/React.createElement(\"video\", {\n        className: \"video\",\n        controls: true,\n        name: \"media\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"source\", {\n        src: `/images/items/${items.item._id}/original/0.mp4`,\n        type: \"video/mp4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 37\n        }\n      })) : null, items.item.file_format === 'pdf' ? this.renderPDF() : null, items.item && items.item._id && items.item.file_format !== 'mp4' && items.item.file_format !== 'pdf' ? /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 29\n        }\n      }, items.item.number_files == null || items.item.number_files < 2 ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_img\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: `/images/items/${items.item._id}/original/0.jpg`,\n        className: \"item_main_img\",\n        alt: \"Item\",\n        onError: i => i.target.style.display = 'none',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 41\n        }\n      })) : null) : null, items.item && items.item.number_files > 1 && items.item.file_format !== 'mp4' && items.item.file_format !== 'pdf' ? this.renderSlider(items) : null, /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 25\n        }\n      }), items.item.creator ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_field item_creator item_review\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 82\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 85\n        }\n      }, \"Creator \")), /*#__PURE__*/React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 104\n        }\n      }, items.item.creator)) : null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_reviewer \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"item_field\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 29\n        }\n      }, items.contributor && items.contributor.name && items.contributor.lastname ? /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 37\n        }\n      }, \"Submitted by: \", items.contributor.name, \" \", items.contributor.lastname, \" - \") : null, /*#__PURE__*/React.createElement(Link, {\n        to: `/user/edit-item/${this.props.match.params.id}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 33\n        }\n      }, \"Edit\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_review\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 21\n        }\n      }, this.renderField('Subject', items.item.subject), this.renderField('Description', items.item.description), this.renderField('Source', items.item.source), this.renderField('Date Created', items.item.date_created), this.renderField('Contributor', items.item.contributor), this.renderField('Item Format', items.item.item_format), this.renderField('Materials', items.item.materials), this.renderField('Physical Dimensions', items.item.physical_dimensions), this.renderField('Pages', items.item.pages), this.renderField('Editor', items.item.editor), this.renderField('Publisher', items.item.publisher), this.renderField('Further Info', items.item.further_info), items.item && items.item.geo ? this.renderField('Address', items.item.geo.address) : null, items.item && items.item.external_link && items.item.external_link[0].url ? /*#__PURE__*/React.createElement(Link, {\n        to: items.item.external_link[0].url,\n        target: \"_blank\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"link_wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 41\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"link_img\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/images/icons/ext_link.png\",\n        className: \"ext_link\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 49\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"link_text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 45\n        }\n      }, items.item.external_link[0].text))) : null), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item_box\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 25\n        }\n      }, this.props.previtem ? /*#__PURE__*/React.createElement(Link, {\n        to: `/items/${this.props.previtem._id}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"white_txt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 41\n        }\n      }, \"Previous Item\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"no_overflow\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 41\n        }\n      }, this.props.previtem.title))) : null), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 25\n        }\n      }, this.props.nextitem ? /*#__PURE__*/React.createElement(Link, {\n        to: `/items/${this.props.nextitem._id}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"white_txt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 41\n        }\n      }, \"Next Item\")), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 41\n        }\n      }, this.props.nextitem.title))) : null)))) : null;\n    };\n  }\n\n  // componentWillMount() {\n  componentDidMount() {\n    this.props.dispatch(getAllCats());\n    this.props.dispatch(getAllSubCats());\n    this.props.dispatch(getItemWithContributor(this.props.match.params.id));\n    this.props.dispatch(getNextItem(this.props.match.params.id));\n    this.props.dispatch(getPrevItem(this.props.match.params.id));\n  }\n\n  componentWillUnmount() {\n    this.props.dispatch(clearItemWithContributor());\n  }\n\n  render() {\n    // console.log(this.props);\n    let items = this.props.items; // console.log(items.item);\n\n    if (items.item && items.item.category_ref) {\n      {\n        this.getCatName(items.item.category_ref);\n      }\n    }\n\n    if (items.item && items.item.subcategory_ref) {\n      // console.log(items.item);\n      {\n        this.getSubCatName(items.item.subcategory_ref);\n      }\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 13\n      }\n    }, this.navInfo.catTitle ? /*#__PURE__*/React.createElement(NavigationBar, {\n      navinfo: this.navInfo,\n      title: items.item.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 21\n      }\n    }) : null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main_view\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 17\n      }\n    }, this.renderItem(items)));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    items: state.items,\n    cats: state.cats.cats,\n    subcats: state.cats.subcats,\n    nextitem: state.items.nextitem,\n    previtem: state.items.previtem\n  };\n}\n\nexport default connect(mapStateToProps)(ItemView);","map":{"version":3,"sources":["/Users/johnlinnane/DEV/traveller-collection/client/src/components/Items/item_view.js"],"names":["React","Component","connect","Link","Slick","Document","Page","pdfjs","getItemWithContributor","clearItemWithContributor","getAllCats","getAllSubCats","getNextItem","getPrevItem","NavigationBar","ItemImageSlider","GlobalWorkerOptions","workerSrc","version","ItemView","state","pdfError","numPages","setNumPages","pageNumber","setPageNumber","pdfPageNumber","navInfo","catTitle","catId","subCatTitle","subCatId","type","addDefaultImg","ev","newImg","target","src","getCatName","props","cats","length","map","cat","_id","title","getSubCatName","subcats","subcat","nextItem","handlePageChange","event","setState","value","renderField","text","ref","__html","renderSlider","items","settings","dots","infinite","arrows","speed","slidesToShow","slidesToScroll","className","divs","i","item","number_files","push","background","renderPDF","onDocumentLoadSuccess","changePage","offset","previousPage","nextPage","renderItem","console","log","file_format","style","display","creator","contributor","name","lastname","match","params","id","subject","description","source","date_created","item_format","materials","physical_dimensions","pages","editor","publisher","further_info","geo","address","external_link","url","previtem","nextitem","componentDidMount","dispatch","componentWillUnmount","render","category_ref","subcategory_ref","mapStateToProps"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,KAAP,MAAkB,aAAlB,C,CAAmC;;AAInC,SAASC,QAAT,EAAmBC,IAAnB,EAAyBC,KAAzB,QAAsC,WAAtC,C,CACA;AAKA;;AACA,SAASC,sBAAT,EAAiCC,wBAAjC,EAA2DC,UAA3D,EAAuEC,aAAvE,EAAsFC,WAAtF,EAAmGC,WAAnG,QAAsH,eAAtH;AACA,OAAOC,aAAP,MAA0B,4BAA1B,C,CACA;;AACA,OAAOC,eAAP,MAA4B,wCAA5B;AAGAR,KAAK,CAACS,mBAAN,CAA0BC,SAA1B,GAAuC,2CAA0CV,KAAK,CAACW,OAAQ,gBAA/F;;AAKA,MAAMC,QAAN,SAAuBlB,SAAvB,CAAiC;AAAA;AAAA;AAAA,SAE7BmB,KAF6B,GAErB;AACJC,MAAAA,QAAQ,EAAE,KADN;AAEJC,MAAAA,QAAQ,EAAE,IAFN;AAGJC,MAAAA,WAAW,EAAE,IAHT;AAIJC,MAAAA,UAAU,EAAE,CAJR;AAKJC,MAAAA,aAAa,EAAE,CALX;AAOJC,MAAAA,aAAa,EAAE;AAPX,KAFqB;AAAA,SAiC7BC,OAjC6B,GAiCnB;AACNC,MAAAA,QAAQ,EAAE,IADJ;AAENC,MAAAA,KAAK,EAAE,IAFD;AAGNC,MAAAA,WAAW,EAAE,IAHP;AAINC,MAAAA,QAAQ,EAAE,IAJJ;AAKNC,MAAAA,IAAI,EAAE;AALA,KAjCmB;;AAAA,SAyC7BC,aAzC6B,GAyCZC,EAAD,IAAQ;AACpB,YAAMC,MAAM,GAAG,6BAAf;;AACA,UAAID,EAAE,CAACE,MAAH,CAAUC,GAAV,KAAkBF,MAAtB,EAA8B;AAC1BD,QAAAA,EAAE,CAACE,MAAH,CAAUC,GAAV,GAAgBF,MAAhB;AACH;AAEJ,KA/C4B;;AAAA,SAiD7BG,UAjD6B,GAiDfT,KAAD,IAAW;AACpB,UAAI,KAAKU,KAAL,CAAWC,IAAX,IAAmB,KAAKD,KAAL,CAAWC,IAAX,CAAgBC,MAAvC,EAA+C;AAC3C,aAAKF,KAAL,CAAWC,IAAX,CAAgBE,GAAhB,CAAqBC,GAAG,IAAI;AAExB,cAAIA,GAAG,CAACC,GAAJ,KAAYf,KAAK,CAAC,CAAD,CAArB,EAA0B;AACtB;AACA,iBAAKF,OAAL,CAAaC,QAAb,GAAwBe,GAAG,CAACE,KAA5B;AACA,iBAAKlB,OAAL,CAAaE,KAAb,GAAqBc,GAAG,CAACC,GAAzB;AACH;;AACD,iBAAO,IAAP;AACH,SARD;AASH;AACJ,KA7D4B;;AAAA,SA+D7BE,aA/D6B,GA+DZf,QAAD,IAAc;AAC1B;AACA,UAAI,KAAKQ,KAAL,CAAWQ,OAAX,IAAsB,KAAKR,KAAL,CAAWQ,OAAX,CAAmBN,MAA7C,EAAqD;AACjD,aAAKF,KAAL,CAAWQ,OAAX,CAAmBL,GAAnB,CAAwBM,MAAM,IAAI;AAE9B,cAAIA,MAAM,CAACJ,GAAP,IAAcb,QAAQ,CAAC,CAAD,CAA1B,EAA+B;AAC3B;AACA,iBAAKJ,OAAL,CAAaG,WAAb,GAA2BkB,MAAM,CAACH,KAAlC;AACA,iBAAKlB,OAAL,CAAaI,QAAb,GAAwBiB,MAAM,CAACJ,GAA/B;AAEH;AACJ,SARD;AASH;AACJ,KA5E4B;;AAAA,SA+E7BK,QA/E6B,GA+ElB,MAAM,CAEhB,CAjF4B;;AAAA,SAmF7BC,gBAnF6B,GAmFTC,KAAD,IAAW;AAC1B,WAAKC,QAAL,CAAc;AACV5B,QAAAA,UAAU,EAAE2B,KAAK,CAACf,MAAN,CAAaiB;AADf,OAAd;AAIH,KAxF4B;;AAAA,SA0F7BC,WA1F6B,GA0Ff,CAACC,IAAD,EAAOC,GAAP,KAAe;AACzB,UAAIA,GAAJ,EAAS;AACL,4BACI;AAAK,UAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAID,IAAJ,CAAH,CADJ,eAGI;AAAM,UAAA,uBAAuB,EAAE;AAACE,YAAAA,MAAM,EAAGD;AAAV,WAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHJ,CADJ;AAOH;AACJ,KApG4B;;AAAA,SA0G7BE,YA1G6B,GA0GbC,KAAD,IAAW;AAGtB,YAAMC,QAAQ,GAAG;AACbC,QAAAA,IAAI,EAAE,IADO;AAEbC,QAAAA,QAAQ,EAAE,KAFG;AAGbC,QAAAA,MAAM,EAAE,IAHK;AAIbC,QAAAA,KAAK,EAAE,GAJM;AAKbC,QAAAA,YAAY,EAAE,CALD;AAMbC,QAAAA,cAAc,EAAE,CANH;AAObC,QAAAA,SAAS,EAAE,cAPE,CAQb;AAKA;;AAba,OAAjB;AAkBA,UAAIC,IAAI,GAAG,EAAX;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,KAAK,CAACW,IAAN,CAAWC,YAA/B,EAA6CF,CAAC,EAA9C,EAAkD;AAC9CD,QAAAA,IAAI,CAACI,IAAL,eACI;AAAK,UAAA,GAAG,EAAEH,CAAV;AAAa,UAAA,SAAS,EAAE,eAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACI;AAAK,UAAA,SAAS,EAAE,gBAAhB;AACK,UAAA,KAAK,EAAE;AACJI,YAAAA,UAAU,EAAG,qBAAoBd,KAAK,CAACW,IAAN,CAAW1B,GAAI,aAAYyB,CAAE,OAD1D,CAEJ;;AAFI,WADZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,CADJ;AAWH;;AAED,0BAAO,oBAAC,KAAD,oBAAWT,QAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAsBQ,IAAtB,CAAP;AAGH,KAlJ4B;;AAAA,SAqJ7BM,SArJ6B,GAqJjB,MAAM;AACd;AACA,YAAM;AAAElD,QAAAA,UAAF;AAAcC,QAAAA,aAAd;AAA6BH,QAAAA,QAA7B;AAAuCC,QAAAA;AAAvC,UAAuD,KAAKH,KAAlE;;AAEA,YAAMuD,qBAAqB,GAAG,CAAC;AAAErD,QAAAA;AAAF,OAAD,KAAkB;AAC5C,aAAK8B,QAAL,CAAc;AAAE9B,UAAAA;AAAF,SAAd;AACA,aAAK8B,QAAL,CAAc;AAAE5B,UAAAA,UAAU,EAAE;AAAd,SAAd;AACH,OAHD;;AAKA,YAAMoD,UAAU,GAAIC,MAAD,IAAY;AAC3B,aAAKzB,QAAL,CAAc;AAAE5B,UAAAA,UAAU,EAAEA,UAAU,GAAGqD;AAA3B,SAAd;AACH,OAFD;;AAIA,YAAMC,YAAY,GAAG,MAAM;AACvBF,QAAAA,UAAU,CAAC,CAAC,CAAF,CAAV;AACH,OAFD;;AAIA,YAAMG,QAAQ,GAAG,MAAM;AACnBH,QAAAA,UAAU,CAAC,CAAD,CAAV;AACH,OAFD,CAjBc,CAoBd;;;AACA,0BACI;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,QAAD;AACI,QAAA,IAAI,EAAC,uDADT;AAEI,QAAA,aAAa,EAAED,qBAFnB,CAGI;AAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAOI,oBAAC,IAAD;AACI,QAAA,SAAS,EAAE,UADf;AAEI,QAAA,UAAU,EAAEnD,UAFhB,CAGI;AAHJ;AAII,QAAA,KAAK,EAAE,GAJX,CAKI;AALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPJ,CADJ,CADJ,eAkBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAlBJ,eAmBI;AACI,QAAA,IAAI,EAAC,QADT;AAEI,QAAA,QAAQ,EAAEA,UAAU,IAAI,CAF5B;AAGI,QAAA,OAAO,EAAEsD,YAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAnBJ,eA0BI;AACI,QAAA,IAAI,EAAC,QADT;AAEI,QAAA,QAAQ,EAAEtD,UAAU,IAAIF,QAF5B;AAGI,QAAA,OAAO,EAAEyD,QAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBA1BJ,eAkCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACUvD,UAAU,KAAKF,QAAQ,GAAG,CAAH,GAAO,IAApB,CADpB,UACmDA,QAAQ,IAAI,IAD/D,CAlCJ,eAuCI;AAAG,QAAA,IAAI,EAAC,uDAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAvCJ,eAyCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAzCJ,eA6CI;AACI,QAAA,IAAI,EAAC,QADT;AAEI,QAAA,WAAW,EAAC,aAFhB;AAGI,QAAA,YAAY,EAAE,KAAKF,KAAL,CAAWI,UAH7B;AAII,QAAA,QAAQ,EAAG2B,KAAD,IAAW,KAAKD,gBAAL,CAAsBC,KAAtB,CAJzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA7CJ,eAqDI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAK/B,KAAL,CAAWI,UAAf,CArDJ,CADJ;AA2DH,KArO4B;;AAAA,SAwO7BwD,UAxO6B,GAwOfrB,KAAD,IAAW;AAOpBsB,MAAAA,OAAO,CAACC,GAAR,CAAYvB,KAAZ;AACA,aAASA,KAAK,CAACW,IAAN,gBAEL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAKI;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAGI;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAKX,KAAK,CAACW,IAAN,CAAWzB,KAAhB,CAFJ,EAKKc,KAAK,CAACW,IAAN,CAAWa,WAAX,IAA0B,KAA1B,gBAEO;AAAO,QAAA,SAAS,EAAC,OAAjB;AAAyB,QAAA,QAAQ,MAAjC;AAAkC,QAAA,IAAI,EAAC,OAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAQ,QAAA,GAAG,EAAG,iBAAgBxB,KAAK,CAACW,IAAN,CAAW1B,GAAI,iBAA7C;AAA+D,QAAA,IAAI,EAAC,WAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CAFP,GAKC,IAVN,EAgBKe,KAAK,CAACW,IAAN,CAAWa,WAAX,KAA2B,KAA3B,GACG,KAAKT,SAAL,EADH,GAEC,IAlBN,EAyBMf,KAAK,CAACW,IAAN,IAAcX,KAAK,CAACW,IAAN,CAAW1B,GAAzB,IAAiCe,KAAK,CAACW,IAAN,CAAWa,WAAX,KAA2B,KAA5D,IAAqExB,KAAK,CAACW,IAAN,CAAWa,WAAX,KAA2B,KAAhG,gBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACMxB,KAAK,CAACW,IAAN,CAAWC,YAAX,IAA2B,IAA3B,IAAmCZ,KAAK,CAACW,IAAN,CAAWC,YAAX,GAA0B,CAA7D,gBACE;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,GAAG,EAAG,iBAAgBZ,KAAK,CAACW,IAAN,CAAW1B,GAAI,iBAA1C;AACA,QAAA,SAAS,EAAC,eADV;AAEA,QAAA,GAAG,EAAC,MAFJ;AAGA,QAAA,OAAO,EAAEyB,CAAC,IAAIA,CAAC,CAACjC,MAAF,CAASgD,KAAT,CAAeC,OAAf,GAAuB,MAHrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADF,GAOA,IARN,CADF,GAWA,IApCN,EAsCM1B,KAAK,CAACW,IAAN,IAAcX,KAAK,CAACW,IAAN,CAAWC,YAAX,GAA0B,CAAxC,IAA6CZ,KAAK,CAACW,IAAN,CAAWa,WAAX,KAA2B,KAAxE,IAAiFxB,KAAK,CAACW,IAAN,CAAWa,WAAX,KAA2B,KAA5G,GACE,KAAKzB,YAAL,CAAkBC,KAAlB,CADF,GAEA,IAxCN,eA2CI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA3CJ,EA8CKA,KAAK,CAACW,IAAN,CAAWgB,OAAX,gBACG;AAAK,QAAA,SAAS,EAAC,qCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAqD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAH,CAArD,eAA2E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAK3B,KAAK,CAACW,IAAN,CAAWgB,OAAhB,CAA3E,CADH,GAEC,IAhDN,eA0DI;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAM,QAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACM3B,KAAK,CAAC4B,WAAN,IAAqB5B,KAAK,CAAC4B,WAAN,CAAkBC,IAAvC,IAA+C7B,KAAK,CAAC4B,WAAN,CAAkBE,QAAjE,gBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAqB9B,KAAK,CAAC4B,WAAN,CAAkBC,IAAvC,OAA8C7B,KAAK,CAAC4B,WAAN,CAAkBE,QAAhE,QADF,GAEA,IAHN,eAII,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAG,mBAAkB,KAAKlD,KAAL,CAAWmD,KAAX,CAAiBC,MAAjB,CAAwBC,EAAG,EAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJJ,CADJ,CA1DJ,CAHJ,eAwEI;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEK,KAAKtC,WAAL,CAAiB,SAAjB,EAA4BK,KAAK,CAACW,IAAN,CAAWuB,OAAvC,CAFL,EAGK,KAAKvC,WAAL,CAAiB,aAAjB,EAAgCK,KAAK,CAACW,IAAN,CAAWwB,WAA3C,CAHL,EAIK,KAAKxC,WAAL,CAAiB,QAAjB,EAA2BK,KAAK,CAACW,IAAN,CAAWyB,MAAtC,CAJL,EAKK,KAAKzC,WAAL,CAAiB,cAAjB,EAAiCK,KAAK,CAACW,IAAN,CAAW0B,YAA5C,CALL,EAMK,KAAK1C,WAAL,CAAiB,aAAjB,EAAgCK,KAAK,CAACW,IAAN,CAAWiB,WAA3C,CANL,EAOK,KAAKjC,WAAL,CAAiB,aAAjB,EAAgCK,KAAK,CAACW,IAAN,CAAW2B,WAA3C,CAPL,EAQK,KAAK3C,WAAL,CAAiB,WAAjB,EAA8BK,KAAK,CAACW,IAAN,CAAW4B,SAAzC,CARL,EASK,KAAK5C,WAAL,CAAiB,qBAAjB,EAAwCK,KAAK,CAACW,IAAN,CAAW6B,mBAAnD,CATL,EAUK,KAAK7C,WAAL,CAAiB,OAAjB,EAA0BK,KAAK,CAACW,IAAN,CAAW8B,KAArC,CAVL,EAWK,KAAK9C,WAAL,CAAiB,QAAjB,EAA2BK,KAAK,CAACW,IAAN,CAAW+B,MAAtC,CAXL,EAYK,KAAK/C,WAAL,CAAiB,WAAjB,EAA8BK,KAAK,CAACW,IAAN,CAAWgC,SAAzC,CAZL,EAaK,KAAKhD,WAAL,CAAiB,cAAjB,EAAiCK,KAAK,CAACW,IAAN,CAAWiC,YAA5C,CAbL,EAiBK5C,KAAK,CAACW,IAAN,IAAcX,KAAK,CAACW,IAAN,CAAWkC,GAAzB,GACG,KAAKlD,WAAL,CAAiB,SAAjB,EAA4BK,KAAK,CAACW,IAAN,CAAWkC,GAAX,CAAeC,OAA3C,CADH,GAEC,IAnBN,EAqBK9C,KAAK,CAACW,IAAN,IAAcX,KAAK,CAACW,IAAN,CAAWoC,aAAzB,IAA0C/C,KAAK,CAACW,IAAN,CAAWoC,aAAX,CAAyB,CAAzB,EAA4BC,GAAtE,gBACW,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAEhD,KAAK,CAACW,IAAN,CAAWoC,aAAX,CAAyB,CAAzB,EAA4BC,GAAtC;AAA4C,QAAA,MAAM,EAAC,QAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,GAAG,EAAC,4BAAT;AAAsC,QAAA,SAAS,EAAC,UAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADJ,eAKI;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACKhD,KAAK,CAACW,IAAN,CAAWoC,aAAX,CAAyB,CAAzB,EAA4BnD,IADjC,CALJ,CADJ,CADX,GAYC,IAjCN,CAxEJ,eA+GI;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKhB,KAAL,CAAWqE,QAAX,gBACG,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAG,UAAS,KAAKrE,KAAL,CAAWqE,QAAX,CAAoBhE,GAAI,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAM,QAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADJ,CADJ,eAII;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAO,KAAKL,KAAL,CAAWqE,QAAX,CAAoB/D,KAA3B,CADJ,CAJJ,CADH,GASC,IAVN,CADJ,eAiBI;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKN,KAAL,CAAWsE,QAAX,gBACG,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAG,UAAS,KAAKtE,KAAL,CAAWsE,QAAX,CAAoBjE,GAAI,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAM,QAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,CADJ,eAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAO,KAAKL,KAAL,CAAWsE,QAAX,CAAoBhE,KAA3B,CADJ,CAJJ,CADH,GASC,IAVN,CAjBJ,CA/GJ,CALJ,CAFK,GAyJP,IAzJF;AA0JH,KA1Y4B;AAAA;;AAa7B;AACAiE,EAAAA,iBAAiB,GAAG;AAChB,SAAKvE,KAAL,CAAWwE,QAAX,CAAoBrG,UAAU,EAA9B;AACA,SAAK6B,KAAL,CAAWwE,QAAX,CAAoBpG,aAAa,EAAjC;AACA,SAAK4B,KAAL,CAAWwE,QAAX,CAAoBvG,sBAAsB,CAAC,KAAK+B,KAAL,CAAWmD,KAAX,CAAiBC,MAAjB,CAAwBC,EAAzB,CAA1C;AACA,SAAKrD,KAAL,CAAWwE,QAAX,CAAoBnG,WAAW,CAAC,KAAK2B,KAAL,CAAWmD,KAAX,CAAiBC,MAAjB,CAAwBC,EAAzB,CAA/B;AACA,SAAKrD,KAAL,CAAWwE,QAAX,CAAoBlG,WAAW,CAAC,KAAK0B,KAAL,CAAWmD,KAAX,CAAiBC,MAAjB,CAAwBC,EAAzB,CAA/B;AAIH;;AAKDoB,EAAAA,oBAAoB,GAAG;AACnB,SAAKzE,KAAL,CAAWwE,QAAX,CAAoBtG,wBAAwB,EAA5C;AACH;;AA+WDwG,EAAAA,MAAM,GAAG;AAEL;AAGA,QAAItD,KAAK,GAAG,KAAKpB,KAAL,CAAWoB,KAAvB,CALK,CAML;;AAEA,QAAIA,KAAK,CAACW,IAAN,IAAcX,KAAK,CAACW,IAAN,CAAW4C,YAA7B,EAA4C;AACxC;AAAC,aAAK5E,UAAL,CAAgBqB,KAAK,CAACW,IAAN,CAAW4C,YAA3B;AAAyC;AAC7C;;AAED,QAAIvD,KAAK,CAACW,IAAN,IAAcX,KAAK,CAACW,IAAN,CAAW6C,eAA7B,EAA+C;AAC3C;AACA;AAAC,aAAKrE,aAAL,CAAmBa,KAAK,CAACW,IAAN,CAAW6C,eAA9B;AAA+C;AACnD;;AAED,wBAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACM,KAAKxF,OAAL,CAAaC,QAAb,gBACE,oBAAC,aAAD;AAAe,MAAA,OAAO,EAAE,KAAKD,OAA7B;AAAsC,MAAA,KAAK,EAAEgC,KAAK,CAACW,IAAN,CAAWzB,KAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,GAEA,IAHN,eAKI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKmC,UAAL,CAAgBrB,KAAhB,CADL,CALJ,CAFJ;AAYH;;AA1a4B;;AA6ajC,SAASyD,eAAT,CAAyBhG,KAAzB,EAAgC;AAC5B,SAAO;AACHuC,IAAAA,KAAK,EAAEvC,KAAK,CAACuC,KADV;AAEHnB,IAAAA,IAAI,EAAEpB,KAAK,CAACoB,IAAN,CAAWA,IAFd;AAGHO,IAAAA,OAAO,EAAE3B,KAAK,CAACoB,IAAN,CAAWO,OAHjB;AAIH8D,IAAAA,QAAQ,EAAEzF,KAAK,CAACuC,KAAN,CAAYkD,QAJnB;AAKHD,IAAAA,QAAQ,EAAExF,KAAK,CAACuC,KAAN,CAAYiD;AALnB,GAAP;AAQH;;AAGD,eAAe1G,OAAO,CAACkH,eAAD,CAAP,CAAyBjG,QAAzB,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport Slick from 'react-slick';   // uses cdn css\n\n\n\nimport { Document, Page, pdfjs } from 'react-pdf';\n// import PDFViewer from 'pdf-viewer-reactjs'\n\n\n\n\n// import { getBookWithReviewer, clearBookWithReviewer } from '../../actions'; // OLD !\nimport { getItemWithContributor, clearItemWithContributor, getAllCats, getAllSubCats, getNextItem, getPrevItem } from '../../actions';\nimport NavigationBar from '../../widgetsUI/navigation';\n// import Image from '../../widgetsUI/Slider/slider';\nimport ItemImageSlider from '../../widgetsUI/Slider/item_img_slider';\n\n\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\n\n\n\n\nclass ItemView extends Component {\n\n    state = {\n        pdfError: false,\n        numPages: null,\n        setNumPages: null,\n        pageNumber: 1,\n        setPageNumber: 1,\n\n        pdfPageNumber: 0\n    }\n\n    \n    // componentWillMount() {\n    componentDidMount() {\n        this.props.dispatch(getAllCats());\n        this.props.dispatch(getAllSubCats());\n        this.props.dispatch(getItemWithContributor(this.props.match.params.id));\n        this.props.dispatch(getNextItem(this.props.match.params.id));\n        this.props.dispatch(getPrevItem(this.props.match.params.id));\n        \n\n\n    }\n\n\n    \n\n    componentWillUnmount() {\n        this.props.dispatch(clearItemWithContributor());\n    }\n\n\n    navInfo = {\n        catTitle: null,\n        catId: null,\n        subCatTitle: null,\n        subCatId: null,\n        type: 'Categories'\n    }\n  \n    addDefaultImg = (ev) => {\n        const newImg = '/images/default/default.jpg';\n        if (ev.target.src !== newImg) {\n            ev.target.src = newImg\n        }  \n        \n    } \n\n    getCatName = (catId) => {\n        if (this.props.cats && this.props.cats.length) {\n            this.props.cats.map( cat => {\n                \n                if (cat._id === catId[0]) {\n                    // console.log(cat.title);\n                    this.navInfo.catTitle = cat.title;\n                    this.navInfo.catId = cat._id;\n                }\n                return null;\n            })\n        }\n    }\n\n    getSubCatName = (subCatId) => {\n        // console.log(subCatId);\n        if (this.props.subcats && this.props.subcats.length) {\n            this.props.subcats.map( subcat => {\n                \n                if (subcat._id == subCatId[0]) {\n                    // console.log(cat.title);\n                    this.navInfo.subCatTitle = subcat.title;\n                    this.navInfo.subCatId = subcat._id;\n\n                }\n            })\n        }\n    }\n\n\n    nextItem = () => {\n\n    }\n\n    handlePageChange = (event) => {\n        this.setState({\n            pageNumber: event.target.value\n        })\n\n    }\n\n    renderField = (text, ref) => {\n        if (ref) {\n            return (\n                <div className=\"item_field link_blue\">\n                    <p><b>{text}</b></p>\n                    \n                    <span dangerouslySetInnerHTML={{__html:  ref}}></span>\n                </div>\n            )\n        } \n    }\n\n\n\n           \n\n    renderSlider = (items) => {\n\n\n        const settings = {\n            dots: true,\n            infinite: false,\n            arrows: true,\n            speed: 500,\n            slidesToShow: 1,\n            slidesToScroll: 1,\n            className: 'slick_slider'\n            // variableWidth: true\n\n            \n\n\n            // ...props.settings\n        }\n\n\n\n        var divs = [];\n        \n        for (var i = 0; i < items.item.number_files; i++) {\n            divs.push( \n                <div key={i} className={\"featured_item\"}> \n                    <div className={\"featured_image\"} \n                         style={{\n                            background: `url(/images/items/${items.item._id}/original/${i}.jpg)`\n                            // <img src={`/images/items/${items.item._id}/original/0.jpg`} alt=\"Item\" onError={this.addDefaultImg}/>\n                         }}\n                    >\n                    </div>\n                </div>\n            )\n        }\n        \n        return <Slick {...settings}>{divs}</Slick>;\n\n\n    }\n\n\n    renderPDF = () => {\n        // ************* PDF STUFF *************\n        const { pageNumber, setPageNumber, numPages, setNumPages } = this.state;\n\n        const onDocumentLoadSuccess = ({ numPages }) => {\n            this.setState({ numPages });\n            this.setState({ pageNumber: 1 });\n        }\n        \n        const changePage = (offset) => {\n            this.setState({ pageNumber: pageNumber + offset});\n        }\n        \n        const previousPage = () => {\n            changePage(-1);\n        }\n        \n        const nextPage = () => {\n            changePage(1);\n        }\n        // ***************************************\n        return (\n            <div className=\"pdf_wrapper\">\n                <div className=\"pdf\">\n                    <Document\n                        file=\"/images/items/5eb4417bf2ff151113f3e178/original/0.pdf\"\n                        onLoadSuccess={onDocumentLoadSuccess}\n                        // onLoadError={this.setState({ pdfError: true })}\n                        \n                        \n                    >\n                        <Page \n                            className={\"pdf_page\"}\n                            pageNumber={pageNumber}\n                            // width={Math.min(width * 0.9, 400)} \n                            width={650} \n                            // scale={0.5}\n                        />\n                    </Document>\n                </div> \n                <br />\n                <button\n                    type=\"button\"\n                    disabled={pageNumber <= 1}\n                    onClick={previousPage}\n                >\n                    Previous\n                </button>\n                <button\n                    type=\"button\"\n                    disabled={pageNumber >= numPages}\n                    onClick={nextPage}\n                >\n                    Next\n                </button>\n\n                <p>\n                    Page {pageNumber || (numPages ? 1 : '--')} of {numPages || '--'}\n                    \n                </p>\n\n                <a href=\"/images/items/5eb4417bf2ff151113f3e178/original/0.pdf\">[pdf]</a>\n                \n                <br />\n                {/* <input readOnly value={this.state.pdfPageNumber} onChange={(e) => {this.handlePageChange(e)}} ref={(input)=> this.myinput = input}/> */}\n\n\n                <input \n                    type=\"number\"\n                    placeholder=\"placeholder\"\n                    defaultValue={this.state.pageNumber} \n                    onChange={(event) => this.handlePageChange(event)}\n                />\n\n\n                <p>{this.state.pageNumber}</p>\n\n                \n            </div> \n        )\n    }\n\n\n    renderItem = (items) => {\n\n\n        \n\n\n\n        console.log(items);\n        return ( items.item ?\n\n            <div>\n                {/* <ItemImageSlider /> */}\n\n                \n\n                <div className=\"item_container\">\n                    \n\n                    <div className=\"item_header\">\n\n                        <h1>{items.item.title}</h1>\n\n\n                        {items.item.file_format == 'mp4' ?\n                            \n                                <video className=\"video\" controls name=\"media\">\n                                    <source src={`/images/items/${items.item._id}/original/0.mp4`} type=\"video/mp4\"/>\n                                </video>\n                        : null }\n\n                        {/* {items.item.file_format === 'pdf' ?\n                            <PDFViewer document={{ url: '/images/items/5eb4417bf2ff151113f3e178/original/0.pdf' }} scale={0.5} scaleStep={0.05} />\n                        : null } */}\n\n                        {items.item.file_format === 'pdf' ?\n                            this.renderPDF()\n                        : null }\n\n                        \n                        \n\n\n\n                        { items.item && items.item._id  && items.item.file_format !== 'mp4' && items.item.file_format !== 'pdf' ?\n                            <div>\n                                { items.item.number_files == null || items.item.number_files < 2 ?\n                                    <div className=\"item_img\">\n                                        <img src={`/images/items/${items.item._id}/original/0.jpg`} \n                                        className=\"item_main_img\"\n                                        alt=\"Item\" \n                                        onError={i => i.target.style.display='none'}/>\n                                    </div>\n                                : null }\n                            </div>\n                        : null}\n\n                        { items.item && items.item.number_files > 1 && items.item.file_format !== 'mp4' && items.item.file_format !== 'pdf' ?\n                            this.renderSlider(items)\n                        : null}\n\n\n                        <br />\n\n                        \n                        {items.item.creator ?\n                            <div className=\"item_field item_creator item_review\"><p><b>Creator </b></p><h5>{items.item.creator}</h5></div>\n                        : null }\n\n\n\n                        {/* <div className=\"item_field link_blue\">\n                            <p><b>{text}</b></p>\n                            \n                            <span dangerouslySetInnerHTML={{__html:  ref}}></span>\n                        </div> */}\n                        \n                        <div className=\"item_reviewer \">\n                            <span className=\"item_field\">\n                                { items.contributor && items.contributor.name && items.contributor.lastname ?\n                                    <span>Submitted by: {items.contributor.name} {items.contributor.lastname} - </span>\n                                : null }\n                                <Link to={`/user/edit-item/${this.props.match.params.id}`}>Edit</Link>\n                            </span>\n                        </div>\n                    </div>\n\n\n                    <div className=\"item_review\">\n\n                        {this.renderField('Subject', items.item.subject)}\n                        {this.renderField('Description', items.item.description)}\n                        {this.renderField('Source', items.item.source)}\n                        {this.renderField('Date Created', items.item.date_created)}\n                        {this.renderField('Contributor', items.item.contributor)}\n                        {this.renderField('Item Format', items.item.item_format)}\n                        {this.renderField('Materials', items.item.materials)}\n                        {this.renderField('Physical Dimensions', items.item.physical_dimensions)}\n                        {this.renderField('Pages', items.item.pages)}\n                        {this.renderField('Editor', items.item.editor)}\n                        {this.renderField('Publisher', items.item.publisher)}\n                        {this.renderField('Further Info', items.item.further_info)}\n                        \n                        \n\n                        {items.item && items.item.geo ?\n                            this.renderField('Address', items.item.geo.address)\n                        : null }\n\n                        {items.item && items.item.external_link && items.item.external_link[0].url ?\n                                    <Link to={items.item.external_link[0].url}  target=\"_blank\">\n                                        <div className=\"link_wrapper\">\n                                            <div className=\"link_img\">\n                                                <img src='/images/icons/ext_link.png' className=\"ext_link\"/>\n                                            </div>\n\n                                            <div className=\"link_text\">\n                                                {items.item.external_link[0].text}\n                                            </div>\n                                        </div>\n                                    </Link>\n                        : null }\n  \n                    </div> \n\n\n\n                    <div className=\"item_box\">\n                        <div className=\"left\">\n                            {this.props.previtem ?\n                                <Link to={`/items/${this.props.previtem._id}`}>\n                                    <div>\n                                        <span className=\"white_txt\">Previous Item</span>\n                                    </div>\n                                    <div className=\"no_overflow\">\n                                        <span>{this.props.previtem.title}</span>\n                                    </div>\n                                </Link>\n                            : null }\n                        </div>\n\n\n\n                        \n                        <div className=\"right\">\n                            {this.props.nextitem ?\n                                <Link to={`/items/${this.props.nextitem._id}`}>\n                                    <div>\n                                        <span className=\"white_txt\">Next Item</span>\n                                    </div>\n                                    <div>\n                                        <span>{this.props.nextitem.title}</span>\n                                    </div>\n                                </Link>\n                            : null }\n                        </div>\n\n                    </div> \n\n\n                </div> \n            </div> \n        : null )\n    }\n\n\n    render() {\n\n        // console.log(this.props);\n\n\n        let items = this.props.items;\n        // console.log(items.item);\n\n        if (items.item && items.item.category_ref ) {\n            {this.getCatName(items.item.category_ref)}\n        }\n\n        if (items.item && items.item.subcategory_ref ) {\n            // console.log(items.item);\n            {this.getSubCatName(items.item.subcategory_ref)}\n        }\n\n        return (\n            \n            <div>\n                { this.navInfo.catTitle  ?\n                    <NavigationBar navinfo={this.navInfo} title={items.item.title}/>    \n                : null }\n\n                <div className=\"main_view\">\n                    {this.renderItem(items)}\n                </div>\n            </div>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        items: state.items,\n        cats: state.cats.cats,\n        subcats: state.cats.subcats,\n        nextitem: state.items.nextitem,\n        previtem: state.items.previtem\n\n    }\n}\n\n\nexport default connect(mapStateToProps)(ItemView)"]},"metadata":{},"sourceType":"module"}