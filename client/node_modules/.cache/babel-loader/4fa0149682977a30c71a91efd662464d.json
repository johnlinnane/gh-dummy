{"ast":null,"code":"var _jsxFileName = \"/Users/johnlinnane/DEV/traveller-collection/client/src/components/AdminSection/admin_info.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { ToastContainer, toast } from 'react-toastify';\nimport { withRouter } from \"react-router-dom\";\nimport { getInfoText, updateInfoText } from '../../actions';\n\nclass AdminInfo extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      formdata: {\n        sections: [{\n          heading: '',\n          paragraph: ''\n        }, {\n          heading: '',\n          paragraph: ''\n        }, {\n          heading: '',\n          paragraph: ''\n        }, {\n          heading: '',\n          paragraph: ''\n        }]\n      }\n    };\n\n    this.onChangeHandler = event => {\n      var files = event.target.files;\n\n      if (this.maxSelectFile(event) && this.checkMimeType(event) && this.checkMimeType(event)) {\n        this.setState({\n          selectedFile: files\n        });\n      }\n    };\n\n    this.onClickHandler = number => {\n      const data = new FormData();\n\n      if (this.state.selectedFile) {\n        for (var x = 0; x < this.state.selectedFile.length; x++) {\n          data.append('file', this.state.selectedFile[x]);\n        } // HOST-SELECT\n\n\n        axios.post(`http://localhost:8000/upload-info/${number}`, data, {\n          // axios.post(`http://64.227.34.134:8000/upload-info/${number}`, data, { \n          // receive two parameter endpoint url ,form data \n          onUploadProgress: ProgressEvent => {\n            this.setState({\n              loaded: ProgressEvent.loaded / ProgressEvent.total * 100\n            });\n          }\n        }).then(res => {\n          // then print response status\n          // console.log(res.config.data.id);\n          // console.log(res.statusText);\n          console.log(res);\n          toast.success('upload success');\n          alert('Files uploaded successfully');\n        }).catch(err => {\n          toast.error('upload fail');\n        });\n      } // this.redirectUser(`/items/${this.props.items.item._id}`)\n\n    };\n\n    this.maxSelectFile = event => {\n      // console.log(event);\n      let files = event.target.files; // create file object\n\n      if (files.length > 1) {\n        const msg = 'Only 1 image can be uploaded at a time';\n        event.target.value = null; // discard selected file\n\n        console.log(msg);\n        return false;\n      }\n\n      return true;\n    };\n\n    this.checkMimeType = event => {\n      //getting file object\n      let files = event.target.files; //define message container\n\n      let err = ''; // list allow mime type\n\n      const types = ['image/png', 'image/jpeg', 'image/gif']; // loop access array\n\n      for (var x = 0; x < files.length; x++) {\n        // compare file type find doesn't matach\n        if (types.every(type => files[x].type !== type)) {\n          // create error message and assign to container   \n          err += files[x].type + ' is not a supported format\\n';\n        }\n      }\n\n      ;\n\n      for (var z = 0; z < err.length; z++) {\n        // loop create toast massage\n        event.target.value = null;\n        toast.error(err[z]);\n      }\n\n      return true;\n    };\n\n    this.checkFileSize = event => {\n      let files = event.target.files;\n      let size = 15000;\n      let err = \"\";\n\n      for (var x = 0; x < files.length; x++) {\n        if (files[x].size > size) {\n          err += files[x].type + 'is too large, please pick a smaller file\\n';\n        }\n      }\n\n      ;\n\n      for (var z = 0; z < err.length; z++) {\n        toast.error(err[z]);\n        event.target.value = null;\n      }\n\n      return true;\n    };\n\n    this.addDefaultImg = ev => {\n      const newImg = '/media/default/default.jpg';\n\n      if (ev.target.src !== newImg) {\n        ev.target.src = newImg;\n      }\n    };\n\n    this.cancel = () => {\n      this.props.history.push(`/admin`);\n    };\n\n    this.handleInput = (event, i, field) => {\n      const newFormdata = { ...this.state.formdata\n      };\n\n      if (field === 'heading') {\n        newFormdata.sections[i].heading = event.target.value;\n      }\n\n      if (field === 'paragraph') {\n        newFormdata.sections[i].paragraph = event.target.value;\n      }\n\n      this.setState({\n        formdata: newFormdata\n      });\n    };\n\n    this.submitForm = e => {\n      e.preventDefault();\n      this.props.dispatch(updateInfoText(this.state.formdata));\n      this.setState({\n        saved: true\n      });\n      setTimeout(() => {\n        this.props.history.push(`/admin`);\n      }, 2000);\n    };\n\n    this.renderRows = () => this.state.formdata.sections.map((section, i) => /*#__PURE__*/React.createElement(\"section\", {\n      className: \"info_table_section\",\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 17\n      }\n    }, \"Paragraph \", i + 1, \" Heading\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: `Paragraph ${i + 1} Heading`,\n      defaultValue: section.heading,\n      onChange: event => this.handleInput(event, i, 'heading'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 17\n      }\n    }, \"Paragraph \", i + 1, \" Body\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"textarea\", {\n      type: \"text\",\n      placeholder: `Paragraph ${i + 1} Content`,\n      defaultValue: section.paragraph,\n      onChange: event => this.handleInput(event, i, 'paragraph'),\n      rows: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 17\n      }\n    }, \"Paragraph \", i + 1, \" Image\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: `/media/info/${i + 1}.jpg`,\n      onError: this.addDefaultImg,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form_element\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      className: \"form-control\",\n      name: \"file\",\n      onChange: this.onChangeHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-success btn-block\",\n      onClick: () => {\n        this.onClickHandler(i + 1);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 25\n      }\n    }, \"Upload\")))), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 33\n      }\n    })))));\n  }\n\n  componentDidMount() {\n    this.props.dispatch(getInfoText());\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props != prevProps) {\n      const infotext = this.props.infotext;\n\n      if (infotext.sections && infotext.sections.length) {\n        let formdata = {\n          sections: [{\n            heading: infotext.sections[0].heading,\n            paragraph: infotext.sections[0].paragraph\n          }, {\n            heading: infotext.sections[1].heading,\n            paragraph: infotext.sections[1].paragraph\n          }, {\n            heading: infotext.sections[2].heading,\n            paragraph: infotext.sections[2].paragraph\n          }, {\n            heading: infotext.sections[3].heading,\n            paragraph: infotext.sections[3].paragraph\n          }]\n        };\n        this.setState({\n          formdata\n        });\n      }\n    }\n  } // *************** UPLOAD LOGIC ********************\n\n\n  render() {\n    console.log(this.state);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"admin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"admin_info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 21\n      }\n    }, \"Edit Info Page\"), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.submitForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 29\n      }\n    }, this.renderRows(), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 37\n      }\n    }, \"Save Changes\")), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.cancel,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 37\n      }\n    }, \"Cancel\")))))), this.state.saved ? /*#__PURE__*/React.createElement(\"p\", {\n      className: \"message center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 25\n      }\n    }, \"Information page updated!\") : null));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  // console.log(state);\n  return {\n    infotext: state.infos.text\n  };\n}\n\nexport default withRouter(connect(mapStateToProps)(AdminInfo));","map":{"version":3,"sources":["/Users/johnlinnane/DEV/traveller-collection/client/src/components/AdminSection/admin_info.js"],"names":["React","Component","connect","axios","ToastContainer","toast","withRouter","getInfoText","updateInfoText","AdminInfo","state","formdata","sections","heading","paragraph","onChangeHandler","event","files","target","maxSelectFile","checkMimeType","setState","selectedFile","onClickHandler","number","data","FormData","x","length","append","post","onUploadProgress","ProgressEvent","loaded","total","then","res","console","log","success","alert","catch","err","error","msg","value","types","every","type","z","checkFileSize","size","addDefaultImg","ev","newImg","src","cancel","props","history","push","handleInput","i","field","newFormdata","submitForm","e","preventDefault","dispatch","saved","setTimeout","renderRows","map","section","componentDidMount","componentDidUpdate","prevProps","prevState","infotext","render","mapStateToProps","infos","text"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { ToastContainer, toast } from 'react-toastify';\nimport { withRouter } from \"react-router-dom\";\n\n\n\nimport { getInfoText, updateInfoText } from '../../actions';\n\n\n\nclass AdminInfo extends Component {\n\n\n    state= {\n        \n        formdata: {\n            sections: [\n                {\n                    heading: '',\n                    paragraph: ''\n                },\n                {\n                    heading: '',\n                    paragraph: ''\n                },\n                {\n                    heading: '',\n                    paragraph: ''\n                },\n                {\n                    heading: '',\n                    paragraph: ''\n                }\n            ]\n            \n        }\n    }\n\n    componentDidMount() {\n        this.props.dispatch(getInfoText());\n\n    }\n\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props != prevProps) {\n\n            const infotext = this.props.infotext;\n\n            if (infotext.sections && infotext.sections.length) {\n                let formdata = {\n                    sections: [\n                        {\n                            heading: infotext.sections[0].heading,\n                            paragraph: infotext.sections[0].paragraph\n                        },\n                        {\n                            heading: infotext.sections[1].heading,\n                            paragraph: infotext.sections[1].paragraph\n                        },\n                        {\n                            heading: infotext.sections[2].heading,\n                            paragraph: infotext.sections[2].paragraph\n                        },\n                        {\n                            heading: infotext.sections[3].heading,\n                            paragraph: infotext.sections[3].paragraph\n                        }\n                    ]\n                    \n                }\n                this.setState({\n                    formdata\n                })\n            }\n\n            \n        }\n    }\n\n\n\n\n\n\n    // *************** UPLOAD LOGIC ********************\n\n    onChangeHandler = (event) => {\n\n\n        var files = event.target.files;\n\n        if (this.maxSelectFile(event) && this.checkMimeType(event) && this.checkMimeType(event)) {  \n            this.setState({\n                selectedFile: files\n            })\n        }\n    }\n\n\n\n    onClickHandler = (number) => {\n        const data = new FormData() \n        \n        if (this.state.selectedFile) {\n            for(var x = 0; x<this.state.selectedFile.length; x++) {\n                data.append('file', this.state.selectedFile[x])\n            }\n\n            // HOST-SELECT\n            axios.post(`http://localhost:8000/upload-info/${number}`, data, {\n            // axios.post(`http://64.227.34.134:8000/upload-info/${number}`, data, { \n                // receive two parameter endpoint url ,form data \n                onUploadProgress: ProgressEvent => {\n                    this.setState({\n                        loaded: (ProgressEvent.loaded / ProgressEvent.total*100)\n                    })\n                }\n            })\n            .then(res => { // then print response status\n                // console.log(res.config.data.id);\n                // console.log(res.statusText);\n                console.log(res);\n                toast.success('upload success')\n                alert('Files uploaded successfully')\n            })\n            .catch(err => { \n                toast.error('upload fail')\n            })\n        }\n        // this.redirectUser(`/items/${this.props.items.item._id}`)\n\n\n    }\n\n    maxSelectFile=(event)=>{\n\n        // console.log(event);\n\n        let files = event.target.files // create file object\n            if (files.length > 1) { \n               const msg = 'Only 1 image can be uploaded at a time'\n               event.target.value = null // discard selected file\n               console.log(msg)\n              return false;\n     \n          }\n        return true;\n     \n    }\n\n    checkMimeType=(event)=>{\n        //getting file object\n        let files = event.target.files \n        //define message container\n        let err = ''\n        // list allow mime type\n        const types = ['image/png', 'image/jpeg', 'image/gif']\n        // loop access array\n        for(var x = 0; x<files.length; x++) {\n         // compare file type find doesn't matach\n            if (types.every(type => files[x].type !== type)) {\n                // create error message and assign to container   \n                err += files[x].type+' is not a supported format\\n';\n            }\n        };\n\n        for(var z = 0; z<err.length; z++) { // loop create toast massage\n            event.target.value = null \n            toast.error(err[z])\n        }\n        return true;\n    }\n\n    checkFileSize=(event)=>{\n        let files = event.target.files\n        let size = 15000 \n        let err = \"\"; \n\n        for(var x = 0; x<files.length; x++) {\n            if (files[x].size > size) {\n                err += files[x].type+'is too large, please pick a smaller file\\n';\n            }\n        };\n\n        for(var z = 0; z<err.length; z++) {\n            toast.error(err[z])\n            event.target.value = null\n        }\n        return true;\n   \n    }    \n\n    // ****************************************************\n\n\n\n\n    addDefaultImg = (ev) => {\n        const newImg = '/media/default/default.jpg';\n        if (ev.target.src !== newImg) {\n            ev.target.src = newImg\n        }  \n    }\n\n    cancel = () => {\n        this.props.history.push(`/admin`)\n    }\n\n\n\n    handleInput = (event, i, field) => {\n\n        const newFormdata = {\n            ...this.state.formdata\n        }\n\n\n        if (field === 'heading') {\n            newFormdata.sections[i].heading = event.target.value\n        }\n\n        if (field === 'paragraph') {\n            newFormdata.sections[i].paragraph = event.target.value\n        }\n\n        this.setState({\n            formdata: newFormdata\n        })\n    }\n\n\n\n    submitForm = (e) => {\n        e.preventDefault();\n\n\n\n        this.props.dispatch(updateInfoText(\n            this.state.formdata\n        ))\n\n   \n        this.setState({\n            saved: true\n        })\n\n        setTimeout(() => {\n            this.props.history.push(`/admin`);\n        }, 2000)\n        \n    }\n\n\n\n    renderRows = () => (\n        this.state.formdata.sections.map( (section, i) => (\n\n\n\n        <section className=\"info_table_section\" key={i}>\n            <tr>\n                <td>\n                    Paragraph {i+1} Heading\n                </td>\n\n                <td>\n                    <input\n                        type=\"text\"\n                        placeholder={`Paragraph ${i+1} Heading`}\n                        defaultValue={section.heading} \n                        onChange={(event) => this.handleInput(event, i, 'heading')}\n                    />\n                </td>\n            </tr>\n\n            \n            <tr>\n                <td>\n                    Paragraph {i + 1} Body\n                </td>\n                <td>\n                    <textarea\n                        type=\"text\"\n                        placeholder={`Paragraph ${i+1} Content`}\n                        defaultValue={section.paragraph} \n                        onChange={(event) => this.handleInput(event, i, 'paragraph')}\n                        rows={6}\n                    />\n                </td>\n            </tr>\n\n            <tr>\n                <td>Paragraph {i + 1} Image</td>\n                <td>\n                    \n                    <img src={`/media/info/${i+1}.jpg`} onError={this.addDefaultImg}/>\n                    <div className=\"form_element\">\n                        <input type=\"file\" className=\"form-control\" name=\"file\" onChange={this.onChangeHandler}/>\n                        <br />\n                        <button type=\"button\" className=\"btn btn-success btn-block\" onClick={ () => {this.onClickHandler(i+1)} }>Upload</button> \n                    </div>\n                </td>\n            </tr>\n\n            <tr>\n                <td colSpan=\"2\"><hr/></td>\n            </tr>\n\n            </section>\n\n\n\n\n\n\n\n\n        ))\n    )\n\n\n    render() {\n\n        console.log(this.state)\n\n\n\n        return (\n\n\n\n            <div className=\"admin\">\n                <div className=\"admin_info\">\n\n                    <h1>Edit Info Page</h1>\n\n\n                    <form onSubmit={this.submitForm}>\n                        <table>\n                            <tbody>\n\n\n\n                            {this.renderRows()}\n\n\n                            <tr>\n                                <td>\n                                    <button type=\"submit\">Save Changes</button>\n                                </td>\n\n                                <td>\n                                    <button type=\"button\" onClick={this.cancel}>Cancel</button>\n                                </td>\n                                \n                            </tr>                  \n\n\n                        </tbody>\n                        </table>\n                    </form>\n\n                    {this.state.saved ?\n                        <p className=\"message center\">Information page updated!</p>\n                    : null}\n\n                    \n                </div>\n            </div>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    // console.log(state);\n\n    return {\n        infotext: state.infos.text\n        \n    }\n}\n\n\nexport default withRouter(connect(mapStateToProps)(AdminInfo));\n\n\n\n"]},"metadata":{},"sourceType":"module"}